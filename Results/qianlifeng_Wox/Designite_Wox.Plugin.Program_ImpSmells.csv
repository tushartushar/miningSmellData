Implementation smell,Namespace,Class,File,Method,Description
Long Parameter List,Wox.Plugin.Program.Programs,UWP,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,SHCreateStreamOnFileEx,The method has 6 parameters. Parameters: fileName' grfMode' attributes' create' reserved' stream
Long Statement,Wox.Plugin.Program,ProgramSetting,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\ProgramSetting.xaml.cs,btnDeleteProgramSource_OnClick,The length of the statement  "                string msg = string.Format(context.API.GetTranslation("wox_plugin_program_delete_program_source")' selectedProgramSource.Location); " is 131.
Long Statement,Wox.Plugin.Program.Programs,UWP,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,InitializeAppInfo,The length of the statement  "                Log.Exception($"|UWP.InitializeAppInfo|SHCreateStreamOnFileEx on path <{path}> failed with HResult <{hResult}> and location <{Location}>."' e); " is 143.
Long Statement,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,ResourceFromPri,The length of the statement  "                    // https://github.com/talynone/Wox.Plugin.WindowsUniversalAppLauncher/blob/master/StoreAppLauncher/Helpers/NativeApiHelper.cs#L139-L153 " is 135.
Long Statement,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,ResourceFromPri,The length of the statement  "                            Log.Error($"|UWP.ResourceFromPri|Can't load null or empty result pri <{source}> with uwp location <{Package.Location}>."); " is 122.
Long Statement,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,ResourceFromPri,The length of the statement  "                        // Microsoft.MicrosoftOfficeHub_17.7608.23501.0_x64__8wekyb3d8bbwe: ms-resource://Microsoft.MicrosoftOfficeHub/officehubintl/AppManifest_GetOffice_Description " is 158.
Long Statement,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,ResourceFromPri,The length of the statement  "                        Log.Exception($"|UWP.ResourceFromPri|Load pri failed <{source}> with HResult <{hResult}> and location <{Package.Location}>."' e); " is 129.
Long Statement,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,LogoPathFromUri,The length of the statement  "                        Log.Error($"|UWP.LogoPathFromUri| <{UserModelId}> can't find logo uri for <{uri}>' Package location <{Package.Location}>."); " is 124.
Long Statement,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,LogoPathFromUri,The length of the statement  "                    Log.Error($"|UWP.LogoPathFromUri| <{UserModelId}> cantains can't find extension for <{uri}> Package location <{Package.Location}>."); " is 133.
Long Statement,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,ImageFromPath,The length of the statement  "                    Log.Error($"|UWP.ImageFromPath|Can't get logo for <{UserModelId}> with path <{path}> and location <{Package.Location}>"); " is 121.
Magic Number,Wox.Plugin.Program,Main,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Main.cs,IndexPrograms,The following statement contains a magic number: var t2 = Task.Run(() =>              {                  var windows10 = new Version(10' 0);                  var support = Environment.OSVersion.Version.Major >= windows10.Major;                  if (support)                  {                      u = UWP.All();                  }                  else                  {                      u = new UWP.Application[] { };                  }              });
Magic Number,Wox.Plugin.Program.Programs,UWP,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,All,The following statement contains a magic number: var windows10 = new Version(10' 0);
Magic Number,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,ResourceFromPri,The following statement contains a magic number: if (!string.IsNullOrWhiteSpace(resourceReference) && resourceReference.StartsWith(prefix))                  {                      // magic comes from @talynone                      // https://github.com/talynone/Wox.Plugin.WindowsUniversalAppLauncher/blob/master/StoreAppLauncher/Helpers/NativeApiHelper.cs#L139-L153                      string key = resourceReference.Substring(prefix.Length);                      string parsed;                      if (key.StartsWith("//"))                      {                          parsed = prefix + key;                      }                      else if (key.StartsWith("/"))                      {                          parsed = prefix + "//" + key;                      }                      else                      {                          parsed = prefix + "///resources/" + key;                      }                        var outBuffer = new StringBuilder(128);                      string source = $"@{{{packageFullName}? {parsed}}}";                      var capacity = (uint)outBuffer.Capacity;                      var hResult = SHLoadIndirectString(source' outBuffer' capacity' IntPtr.Zero);                      if (hResult == Hresult.Ok)                      {                          var loaded = outBuffer.ToString();                          if (!string.IsNullOrEmpty(loaded))                          {                              return loaded;                          }                          else                          {                              Log.Error($"|UWP.ResourceFromPri|Can't load null or empty result pri <{source}> with uwp location <{Package.Location}>.");                              return string.Empty;                          }                      }                      else                      {                          // https://github.com/Wox-launcher/Wox/issues/964                          // known hresult 2147942522:                          // 'Microsoft Corporation' violates pattern constraint of '\bms-resource:.{1'256}'.                          // for                          // Microsoft.MicrosoftOfficeHub_17.7608.23501.0_x64__8wekyb3d8bbwe: ms-resource://Microsoft.MicrosoftOfficeHub/officehubintl/AppManifest_GetOffice_Description                          // Microsoft.BingFoodAndDrink_3.0.4.336_x64__8wekyb3d8bbwe: ms-resource:AppDescription                          var e = Marshal.GetExceptionForHR((int)hResult);                          Log.Exception($"|UWP.ResourceFromPri|Load pri failed <{source}> with HResult <{hResult}> and location <{Package.Location}>."' e);                          return string.Empty;                      }                  }                  else                  {                      return resourceReference;                  }
Magic Number,Wox.Plugin.Program.Programs,Application,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\UWP.cs,PlatedImage,The following statement contains a magic number: if (!string.IsNullOrEmpty(BackgroundColor) && BackgroundColor != "transparent")                  {                      var width = image.Width;                      var height = image.Height;                      var x = 0;                      var y = 0;                        var group = new DrawingGroup();                        var converted = ColorConverter.ConvertFromString(BackgroundColor);                      if (converted != null)                      {                          var color = (Color)converted;                          var brush = new SolidColorBrush(color);                          var pen = new Pen(brush' 1);                          var backgroundArea = new Rect(0' 0' width' width);                          var rectabgle = new RectangleGeometry(backgroundArea);                          var rectDrawing = new GeometryDrawing(brush' pen' rectabgle);                          group.Children.Add(rectDrawing);                            var imageArea = new Rect(x' y' image.Width' image.Height);                          var imageDrawing = new ImageDrawing(image' imageArea);                          group.Children.Add(imageDrawing);                            // http://stackoverflow.com/questions/6676072/get-system-drawing-bitmap-of-a-wpf-area-using-visualbrush                          var visual = new DrawingVisual();                          var context = visual.RenderOpen();                          context.DrawDrawing(group);                          context.Close();                          const int dpiScale100 = 96;                          var bitmap = new RenderTargetBitmap(                              Convert.ToInt32(width)' Convert.ToInt32(height)'                              dpiScale100' dpiScale100'                              PixelFormats.Pbgra32                          );                          bitmap.Render(visual);                          return bitmap;                      }                      else                      {                          Log.Error($"|UWP.PlatedImage| Can't convert background string <{BackgroundColor}> to color for <{Package.Location}>.");                          return new BitmapImage(new Uri(Constant.ErrorIcon));                      }                  }                  else                  {                      // todo use windows theme as background                      return image;                  }
Magic Number,Wox.Plugin.Program.Programs,Win32,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.Program\Programs\Win32.cs,LnkProgram,The following statement contains a magic number: try              {                  var link = new ShellLink();                  const uint STGM_READ = 0;                  ((IPersistFile)link).Load(path' STGM_READ);                  var hwnd = new _RemotableHandle();                  link.Resolve(ref hwnd' 0);                    const int MAX_PATH = 260;                  StringBuilder buffer = new StringBuilder(MAX_PATH);                    var data = new _WIN32_FIND_DATAW();                  const uint SLGP_SHORTPATH = 1;                  link.GetPath(buffer' buffer.Capacity' ref data' SLGP_SHORTPATH);                  var target = buffer.ToString();                  if (!string.IsNullOrEmpty(target))                  {                      var extension = Extension(target);                      if (extension == ExeExtension && File.Exists(target))                      {                          buffer = new StringBuilder(MAX_PATH);                          link.GetDescription(buffer' MAX_PATH);                          var description = buffer.ToString();                          if (!string.IsNullOrEmpty(description))                          {                              program.Description = description;                          }                          else                          {                              var info = FileVersionInfo.GetVersionInfo(target);                              if (!string.IsNullOrEmpty(info.FileDescription))                              {                                  program.Description = info.FileDescription;                              }                          }                      }                  }                  return program;              }              catch (COMException e)              {                  // C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\MiracastView.lnk always cause exception                  Log.Exception($"|Win32.LnkProgram|COMException when parsing shortcut <{path}> with HResult <{e.HResult}>"' e);                  program.Valid = false;                  return program;              }              catch (Exception e)              {                  Log.Exception($"|Win32.LnkProgram|Exception when parsing shortcut <{path}>"' e);                  program.Valid = false;                  return program;              }
