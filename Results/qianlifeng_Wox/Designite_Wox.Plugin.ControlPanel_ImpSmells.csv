Implementation smell,Namespace,Class,File,Method,Description
Complex Method,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getIcon,Cyclomatic complexity of the method is 9
Long Parameter List,Wox.Plugin.ControlPanel,ControlPanelItem,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelItem.cs,ControlPanelItem,The method has 5 parameters. Parameters: newLocalizedString' newInfoTip' newGUID' newExecutablePath' newIcon
Long Parameter List,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,LoadImage,The method has 6 parameters. Parameters: hinst' lpszName' uType' cxDesired' cyDesired' fuLoad
Long Statement,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getExecutablePath,The length of the statement  "            else if (currentKey.OpenSubKey("Shell\\Open\\Command") != null && currentKey.OpenSubKey("Shell\\Open\\Command").GetValue(null) != null) " is 135.
Long Statement,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getExecutablePath,The length of the statement  "                string input = "\"" + Environment.ExpandEnvironmentVariables(currentKey.OpenSubKey("Shell\\Open\\Command").GetValue(null).ToString()) + "\""; " is 141.
Empty Catch Block,Wox.Plugin.ControlPanel,Main,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\Main.cs,Query,The method has an empty catch block.
Empty Catch Block,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getIcon,The method has an empty catch block.
Magic Number,Wox.Plugin.ControlPanel,Main,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\Main.cs,Init,The following statement contains a magic number: controlPanelItems = ControlPanelList.Create(48);
Magic Number,Wox.Plugin.ControlPanel,Main,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\Main.cs,Query,The following statement contains a magic number: List<Result> panelItems = results.OrderByDescending(o => o.Score).Take(5).ToList();
Magic Number,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getLocalizedString,The following statement contains a magic number: if (currentKey.GetValue("LocalizedString") != null)              {                  localizedStringRaw = currentKey.GetValue("LocalizedString").ToString().Split(new[] { "'-" }' StringSplitOptions.None);                    if (localizedStringRaw.Length > 1)                  {                      if (localizedStringRaw[0][0] == '@')                      {                          localizedStringRaw[0] = localizedStringRaw[0].Substring(1);                      }                        localizedStringRaw[0] = Environment.ExpandEnvironmentVariables(localizedStringRaw[0]);                        dataFilePointer = LoadLibraryEx(localizedStringRaw[0]' IntPtr.Zero' LOAD_LIBRARY_AS_DATAFILE); //Load file with strings                        stringTableIndex = sanitizeUint(localizedStringRaw[1]);                        resource = new StringBuilder(255);                      LoadString(dataFilePointer' stringTableIndex' resource' resource.Capacity + 1); //Extract needed string                      FreeLibrary(dataFilePointer);                        localizedString = resource.ToString();                        //Some apps don't return a string' although they do have a stringIndex. Use Default value.                        if (String.IsNullOrEmpty(localizedString))                      {                          if (currentKey.GetValue(null) != null)                          {                              localizedString = currentKey.GetValue(null).ToString();                          }                          else                          {                              return null; //Cannot have item without title.                          }                      }                  }                  else                  {                      localizedString = localizedStringRaw[0];                  }              }              else if (currentKey.GetValue(null) != null)              {                  localizedString = currentKey.GetValue(null).ToString();              }              else              {                  return null; //Cannot have item without title.              }
Magic Number,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getInfoTip,The following statement contains a magic number: if (currentKey.GetValue("InfoTip") != null)              {                  infoTipRaw = currentKey.GetValue("InfoTip").ToString().Split(new[] { "'-" }' StringSplitOptions.None);                    if (infoTipRaw.Length == 2)                  {                      if (infoTipRaw[0][0] == '@')                      {                          infoTipRaw[0] = infoTipRaw[0].Substring(1);                      }                      infoTipRaw[0] = Environment.ExpandEnvironmentVariables(infoTipRaw[0]);                        dataFilePointer = LoadLibraryEx(infoTipRaw[0]' IntPtr.Zero' LOAD_LIBRARY_AS_DATAFILE); //Load file with strings                        stringTableIndex = sanitizeUint(infoTipRaw[1]);                        resource = new StringBuilder(255);                      LoadString(dataFilePointer' stringTableIndex' resource' resource.Capacity + 1); //Extract needed string                      FreeLibrary(dataFilePointer);                        infoTip = resource.ToString();                  }                  else                  {                      infoTip = currentKey.GetValue("InfoTip").ToString();                  }              }              else              {                  infoTip = "";              }
Magic Number,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getInfoTip,The following statement contains a magic number: if (currentKey.GetValue("InfoTip") != null)              {                  infoTipRaw = currentKey.GetValue("InfoTip").ToString().Split(new[] { "'-" }' StringSplitOptions.None);                    if (infoTipRaw.Length == 2)                  {                      if (infoTipRaw[0][0] == '@')                      {                          infoTipRaw[0] = infoTipRaw[0].Substring(1);                      }                      infoTipRaw[0] = Environment.ExpandEnvironmentVariables(infoTipRaw[0]);                        dataFilePointer = LoadLibraryEx(infoTipRaw[0]' IntPtr.Zero' LOAD_LIBRARY_AS_DATAFILE); //Load file with strings                        stringTableIndex = sanitizeUint(infoTipRaw[1]);                        resource = new StringBuilder(255);                      LoadString(dataFilePointer' stringTableIndex' resource' resource.Capacity + 1); //Extract needed string                      FreeLibrary(dataFilePointer);                        infoTip = resource.ToString();                  }                  else                  {                      infoTip = currentKey.GetValue("InfoTip").ToString();                  }              }              else              {                  infoTip = "";              }
Magic Number,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getIcon,The following statement contains a magic number: if (currentKey.OpenSubKey("DefaultIcon") != null)              {                  if (currentKey.OpenSubKey("DefaultIcon").GetValue(null) != null)                  {                      iconString = new List<string>(currentKey.OpenSubKey("DefaultIcon").GetValue(null).ToString().Split(new[] { ''' }' 2));                      if (string.IsNullOrEmpty(iconString[0]))                      {                          // fallback to default icon                          return null;                      }                        if (iconString[0][0] == '@')                      {                          iconString[0] = iconString[0].Substring(1);                      }                        dataFilePointer = LoadLibraryEx(iconString[0]' IntPtr.Zero' LOAD_LIBRARY_AS_DATAFILE);                        if (iconString.Count == 2)                      {                          iconIndex = (IntPtr)sanitizeUint(iconString[1]);                            iconPtr = LoadImage(dataFilePointer' iconIndex' 1' iconSize' iconSize' 0);                      }                        if (iconPtr == IntPtr.Zero)                      {                          defaultIconPtr = IntPtr.Zero;                          EnumResourceNamesWithID(dataFilePointer' GROUP_ICON' EnumRes' IntPtr.Zero); //Iterate through resources.                             iconPtr = LoadImage(dataFilePointer' defaultIconPtr' 1' iconSize' iconSize' 0);                      }                        FreeLibrary(dataFilePointer);                        if (iconPtr != IntPtr.Zero)                      {                          try                          {                              myIcon = Icon.FromHandle(iconPtr);                              myIcon = (Icon)myIcon.Clone(); //Remove pointer dependancy.                          }                          catch                          {                              //Silently fail for now.                          }                      }                  }              }
Magic Number,Wox.Plugin.ControlPanel,ControlPanelList,C:\repos\qianlifeng_Wox\Plugins\Wox.Plugin.ControlPanel\ControlPanelList.cs,getIcon,The following statement contains a magic number: if (currentKey.OpenSubKey("DefaultIcon") != null)              {                  if (currentKey.OpenSubKey("DefaultIcon").GetValue(null) != null)                  {                      iconString = new List<string>(currentKey.OpenSubKey("DefaultIcon").GetValue(null).ToString().Split(new[] { ''' }' 2));                      if (string.IsNullOrEmpty(iconString[0]))                      {                          // fallback to default icon                          return null;                      }                        if (iconString[0][0] == '@')                      {                          iconString[0] = iconString[0].Substring(1);                      }                        dataFilePointer = LoadLibraryEx(iconString[0]' IntPtr.Zero' LOAD_LIBRARY_AS_DATAFILE);                        if (iconString.Count == 2)                      {                          iconIndex = (IntPtr)sanitizeUint(iconString[1]);                            iconPtr = LoadImage(dataFilePointer' iconIndex' 1' iconSize' iconSize' 0);                      }                        if (iconPtr == IntPtr.Zero)                      {                          defaultIconPtr = IntPtr.Zero;                          EnumResourceNamesWithID(dataFilePointer' GROUP_ICON' EnumRes' IntPtr.Zero); //Iterate through resources.                             iconPtr = LoadImage(dataFilePointer' defaultIconPtr' 1' iconSize' iconSize' 0);                      }                        FreeLibrary(dataFilePointer);                        if (iconPtr != IntPtr.Zero)                      {                          try                          {                              myIcon = Icon.FromHandle(iconPtr);                              myIcon = (Icon)myIcon.Clone(); //Remove pointer dependancy.                          }                          catch                          {                              //Silently fail for now.                          }                      }                  }              }
