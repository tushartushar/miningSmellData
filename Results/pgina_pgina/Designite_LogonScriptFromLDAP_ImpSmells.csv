Implementation smell,Namespace,Class,File,Method,Description
Long Method,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The method has 107 lines of code.
Long Parameter List,pGina.Plugin.LogonScriptFromLDAP,SafeNativeMethods,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LogonScriptPlug_pInvokes.cs,CreateProcessAsUser,The method has 11 parameters. Parameters: hToken' lpApplicationName' lpCommandLine' lpProcessAttributes' lpThreadAttributes' bInheritHandles' dwCreationFlags' lpEnvironment' lpCurrentDirectory' lpStartupInfo' lpProcessInformation
Long Parameter List,pGina.Plugin.LogonScriptFromLDAP,PinvokeWindowsNetworking,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\PinvokeWindowsNetworking.cs,WNetUseConnection,The method has 8 parameters. Parameters: hwndOwner' lpNetResource' lpPassword' lpUserID' dwFlags' lpAccessName' lpBufferSize' lpResult
Long Statement,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,StoreSettings,The length of the statement  "                Settings.Store.Domain = domain_TextBox.Text.Trim().Remove(domain_TextBox.Text.Trim().Length - 1); // we remove the potential useless \ at the end of the string " is 159.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The length of the statement  "            this.toolTip1.SetToolTip(this.attribute_label' "Name of the attribute corresponding to the name of the logon script you\'re lookin" + " is 133.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The length of the statement  "            this.toolTip1.SetToolTip(this.attribute_TextBox' "Name of the attribute corresponding to the name of the logon script you\'re lookin" + " is 135.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,LdapServer,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LdapServer.cs,Authenticate,The length of the statement  "                return new BooleanResult { Success = false' Message = "Please make sure the configuration is correct. Retrieving Dn and/or script name didn't work correctly." }; " is 161.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,LdapServer,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LdapServer.cs,Authenticate,The length of the statement  "                return new BooleanResult { Success = false' Message = "Impossible to find script name. Make sure the config is correct." }; " is 123.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,LdapServer,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LdapServer.cs,FindFirstDN,The length of the statement  "            SearchRequest req = new SearchRequest(searchBase' filter' System.DirectoryServices.Protocols.SearchScope.Subtree' null); " is 120.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,LdapServer,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LdapServer.cs,RetrieveScriptName,The length of the statement  "            SearchRequest req = new SearchRequest(searchBase' filter' System.DirectoryServices.Protocols.SearchScope.Subtree' null); " is 120.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,PluginImpl,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Plugin.cs,SessionChange,The length of the statement  "            if (changeDescription.Reason.Equals(System.ServiceProcess.SessionChangeReason.SessionLogon)) // checking if we just logged in " is 125.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,PluginImpl,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Plugin.cs,ServerPart,The length of the statement  "                    pluginImpl_logger.DebugFormat("Connection to [" + remoteUNC + "] with credentials given in the first user authentication."); " is 124.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,PluginImpl,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Plugin.cs,ScriptExecution,The length of the statement  "                         // we insert a /c at index 0 of the command line so that cmd.exe understands he has to execute it and close the terminal " is 120.
Long Statement,pGina.Plugin.LogonScriptFromLDAP,PluginImpl,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Plugin.cs,ScriptExecution,The length of the statement  "                         pluginImpl_logger.DebugFormat("Caught a Win32Exception error (Message: {0}). Probably tried to read an incorrect command. Error {1}"' e.Message' Marshal.GetLastWin32Error()); " is 174.
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_label.Location = new System.Drawing.Point(45' 34);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_label.Location = new System.Drawing.Point(45' 34);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_label.Size = new System.Drawing.Size(206' 13);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_label.Size = new System.Drawing.Size(206' 13);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_label.Location = new System.Drawing.Point(44' 94);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_label.Location = new System.Drawing.Point(44' 94);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_label.Size = new System.Drawing.Size(163' 13);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_label.Size = new System.Drawing.Size(163' 13);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_TextBox.Location = new System.Drawing.Point(47' 50);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_TextBox.Location = new System.Drawing.Point(47' 50);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_TextBox.Size = new System.Drawing.Size(204' 20);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_TextBox.Size = new System.Drawing.Size(204' 20);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.attribute_TextBox.TabIndex = 2;
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_TextBox.Location = new System.Drawing.Point(47' 110);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_TextBox.Location = new System.Drawing.Point(47' 110);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_TextBox.Size = new System.Drawing.Size(204' 20);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_TextBox.Size = new System.Drawing.Size(204' 20);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.server_TextBox.TabIndex = 3;
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.save_btn.Location = new System.Drawing.Point(191' 215);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.save_btn.Location = new System.Drawing.Point(191' 215);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.save_btn.Size = new System.Drawing.Size(77' 31);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.save_btn.Size = new System.Drawing.Size(77' 31);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.cancel_btn.Location = new System.Drawing.Point(109' 215);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.cancel_btn.Location = new System.Drawing.Point(109' 215);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.cancel_btn.Size = new System.Drawing.Size(77' 31);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.cancel_btn.Size = new System.Drawing.Size(77' 31);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.cancel_btn.TabIndex = 5;
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.domain_TextBox.Location = new System.Drawing.Point(47' 163);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.domain_TextBox.Location = new System.Drawing.Point(47' 163);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.domain_TextBox.Size = new System.Drawing.Size(204' 20);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.domain_TextBox.Size = new System.Drawing.Size(204' 20);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.domain_TextBox.TabIndex = 4;
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.label1.Location = new System.Drawing.Point(45' 144);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.label1.Location = new System.Drawing.Point(45' 144);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.label1.Size = new System.Drawing.Size(91' 13);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.label1.Size = new System.Drawing.Size(91' 13);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.label1.TabIndex = 7;
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.ClientSize = new System.Drawing.Size(306' 269);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,Configuration,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Configuration.cs,InitializeComponent,The following statement contains a magic number: this.ClientSize = new System.Drawing.Size(306' 269);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,LdapServer,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LdapServer.cs,LdapServer,The following statement contains a magic number: Timeout = (int)Registry.GetValue(LdapPluginPath' "LdapTimeout"' 10);
Magic Number,pGina.Plugin.LogonScriptFromLDAP,LdapServer,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LdapServer.cs,Connect,The following statement contains a magic number: m_conn.SessionOptions.ProtocolVersion = 3;
Magic Number,pGina.Plugin.LogonScriptFromLDAP,LdapServer,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\LdapServer.cs,Authenticate,The following statement contains a magic number: try              {                  this.Bind(ldapCredential);              }              catch (LdapException e)              {                  // 49 is invalid credentials                  if (e.ErrorCode == 49)                  {                      server_logger.ErrorFormat("LDAP bind failed: invalid credentials.");                      return new BooleanResult { Success = false' Message = "Authentication via LDAP failed. Invalid credentials." };                  }                    // Let caller handle other kinds of exceptions                  throw;              }
Magic Number,pGina.Plugin.LogonScriptFromLDAP,PluginImpl,C:\repos\pgina_pgina\Plugins\Contrib\GetLogonScriptFromLDAP\Plugin.cs,LdapPart,The following statement contains a magic number: try              {                  pluginImpl_logger.DebugFormat("AuthenticateUser({0})"' properties.Id.ToString());                    // retrieving user's information stored during Gateway stage                  Shared.Types.UserInformation userInfo = properties.GetTrackedSingle<Shared.Types.UserInformation>();                  string userLogin = properties.GetTracked<string>("UserLogin");                  string userPassword = properties.GetTracked<string>("UserPassword");                  pluginImpl_logger.DebugFormat("Received username: {0}"' userLogin);                    // Authenticate the login                  pluginImpl_logger.DebugFormat("Attempting authentication for {0}"' userLogin);                  BooleanResult authenticateBool = server.Authenticate(userLogin' userPassword);                    if (!authenticateBool.Success) // authentication and attribute value retrieving didn't work                  {                      pluginImpl_logger.ErrorFormat("LDAP Authentication failed. {0}" ' authenticateBool.Message);                      return;                  }                    // retrieves the script name from Ldap                  this.scriptName = server.GetScriptName();                  pluginImpl_logger.DebugFormat("Name of the script file:  {0}"'this.scriptName);                    // cleans up any resources held by the plugin                  LdapEnd(properties);              }              catch (Exception e)              {                  if (e is LdapException)                  {                      LdapException ldapEx = (e as LdapException);                        if (ldapEx.ErrorCode == 81)                      {                          // Server can't be contacted' set server object to null                          pluginImpl_logger.ErrorFormat("Server unavailable: {0}' {1}"' ldapEx.ServerErrorMessage' e.Message);                          server.Close();                          properties.AddTrackedSingle<LdapServer>(null);                          return;                      }                  }                    // This is an unexpected error' so set LdapServer object to null' because                  // subsequent stages shouldn't use it' and this indicates to later stages                  // that this stage failed unexpectedly.                  server.Close();                  properties.AddTrackedSingle<LdapServer>(null);                  pluginImpl_logger.ErrorFormat("Exception in LDAP authentication: {0}"' e);                  throw;  // Allow pGina service to catch and handle exception              }
