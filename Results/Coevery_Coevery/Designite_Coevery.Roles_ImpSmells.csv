Implementation smell,Namespace,Class,File,Method,Description
Complex Method,Coevery.Roles.Services,RolesBasedAuthorizationService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RolesBasedAuthorizationService.cs,TryCheckAccess,Cyclomatic complexity of the method is 12
Long Parameter List,Coevery.Roles.Drivers,UserTaskDriver,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Drivers\UserTaskDriver.cs,UserTaskDriver,The method has 5 parameters. Parameters: services' workflowManager' awaitingActivityRepository' workContextAccessor' httpContextAccessor
Long Parameter List,Coevery.Roles.Drivers,UserRolesPartDriver,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Drivers\UserRolesPartDriver.cs,UserRolesPartDriver,The method has 5 parameters. Parameters: userRolesRepository' roleService' notifier' authenticationService' authorizationService
Long Parameter List,Coevery.Roles.Services,RoleService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RoleService.cs,RoleService,The method has 6 parameters. Parameters: roleRepository' permissionRepository' userRolesRepository' permissionProviders' cacheManager' signals
Long Identifier,Coevery.Roles.Services,RolesBasedAuthorizationService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RolesBasedAuthorizationService.cs,RolesBasedAuthorizationService,The length of the parameter authorizationServiceEventHandler is 32.
Long Identifier,Coevery.Roles.Services,RolesBasedAuthorizationService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RolesBasedAuthorizationService.cs,,The length of the parameter _authorizationServiceEventHandler is 33.
Long Statement,Coevery.Roles.Controllers,RoleController,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Controllers\RoleController.cs,Delete,The length of the statement  "                return Request.CreateErrorResponse(HttpStatusCode.NonAuthoritativeInformation' T("Not authorized to manage roles").Text); " is 121.
Long Statement,Coevery.Roles.Drivers,UserTaskDriver,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Drivers\UserTaskDriver.cs,Editor,The length of the statement  "                    var awaiting = _awaitingActivityRepository.Table.Where(x => x.WorkflowRecord.ContentItemRecord == part.ContentItem.Record && x.ActivityRecord.Name == "UserTask").ToList(); " is 171.
Long Statement,Coevery.Roles.Drivers,UserTaskDriver,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Drivers\UserTaskDriver.cs,Editor,The length of the statement  "                var awaiting = _awaitingActivityRepository.Table.Where(x => x.WorkflowRecord.ContentItemRecord == part.ContentItem.Record && x.ActivityRecord.Name == "UserTask").ToList(); " is 171.
Long Statement,Coevery.Roles.Drivers,UserTaskDriver,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Drivers\UserTaskDriver.cs,Editor,The length of the statement  "                    _workflowManager.TriggerEvent("UserTask"' part' () => new Dictionary<string' object> { { "Content"' part.ContentItem}' { "UserTask.Action"' name } }); " is 150.
Long Statement,Coevery.Roles.Drivers,UserRolesPartDriver,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Drivers\UserRolesPartDriver.cs,Editor,The length of the statement  "            if (!_authorizationService.TryCheckAccess(StandardPermissions.SiteOwner' _authenticationService.GetAuthenticatedUser()' userRolesPart)) " is 135.
Long Statement,Coevery.Roles.Drivers,UserRolesPartDriver,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Drivers\UserRolesPartDriver.cs,Editor,The length of the statement  "            if (!_authorizationService.TryCheckAccess(StandardPermissions.SiteOwner' _authenticationService.GetAuthenticatedUser()' userRolesPart)) " is 135.
Long Statement,Coevery.Roles.ImportExport,RolesExportEventHandler,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\ImportExport\RolesExportEventHandler.cs,Exported,The length of the statement  "                                      new XAttribute("Permissions"' string.Join("'"' role.RolesPermissions.Select(rolePermission => rolePermission.Permission.Name))))); " is 130.
Long Statement,Coevery.Roles.ImportExport,RolesRecipeHandler,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\ImportExport\RolesRecipeHandler.cs,ExecuteRecipeStep,The length of the statement  "                var permissions = roleElement.Attribute("Permissions").Value.Split(new[] { ''' }' StringSplitOptions.RemoveEmptyEntries); " is 121.
Long Statement,Coevery.Roles.ImportExport,RolesRecipeHandler,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\ImportExport\RolesRecipeHandler.cs,ExecuteRecipeStep,The length of the statement  "                _roleService.UpdateRole(role.Id' role.Name' permissionsValid.Union(role.RolesPermissions.Select(p => p.Permission.Name))); " is 122.
Long Statement,Coevery.Roles.Services,RolesBasedAuthorizationService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RolesBasedAuthorizationService.cs,TryCheckAccess,The length of the statement  "                           String.Equals(context.User.UserName' _workContextAccessor.GetContext().CurrentSite.SuperUser' StringComparison.Ordinal)) { " is 122.
Long Statement,Coevery.Roles.Services,RolesBasedAuthorizationService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RolesBasedAuthorizationService.cs,TryCheckAccess,The length of the statement  "                            if (grantingNames.Any(grantingName => String.Equals(possessedName' grantingName' StringComparison.OrdinalIgnoreCase))) { " is 120.
Long Statement,Coevery.Roles.Services,RoleService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RoleService.cs,GetFeatureName,The length of the statement  "            throw new ArgumentException(T("Permission {0} was not found in any of the installed modules."' permissionName).ToString()); " is 123.
Long Statement,Coevery.Roles.Services,RoleService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RoleService.cs,GetPermissionDescription,The length of the statement  "            throw new ArgumentException(T("Permission {0} was not found in any of the installed modules."' permissionName).ToString()); " is 123.
Magic Number,Coevery.Roles.Forms,SelectRolesForms,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Forms\SelectRolesForms.cs,Describe,The following statement contains a magic number: Func<IShapeFactory' dynamic> form =                  shape => {                        var f = Shape.Form(                          Id: "AnyOfRoles"'                          _Parts: Shape.SelectList(                              Id: "role"' Name: "Roles"'                              Title: T("Roles")'                              Description: T("Select some roles.")'                              Size: 10'                              Multiple: true                              )                          );                        f._Parts.Add(new SelectListItem { Value = ""' Text = T("Any").Text });                        foreach (var role in _roleService.GetRoles().OrderBy(x => x.Name)) {                          f._Parts.Add(new SelectListItem { Value = role.Name' Text = role.Name });                      }                        return f;                  };
Magic Number,Coevery.Roles.Forms,UserTaskForms,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Forms\UserTaskForms.cs,Describe,The following statement contains a magic number: Func<IShapeFactory' dynamic> form =                  shape => {                        var f = Shape.Form(                          Id: "AnyOfRoles"'                          _Parts: Shape.SelectList(                              Id: "role"' Name: "Roles"'                              Title: T("Roles")'                              Description: T("Select some roles.")'                              Size: 10'                              Multiple: true                              )'                          _Message: Shape.Textbox(                              Id: "actions"' Name: "Actions"'                              Title: T("Available actions.")'                              Description: T("A comma separated list of actions.")'                              Classes: new[] { "text medium" })                          );                        f._Parts.Add(new SelectListItem { Value = ""' Text = T("Any").Text });                        foreach (var role in _roleService.GetRoles().OrderBy(x => x.Name)) {                          f._Parts.Add(new SelectListItem { Value = role.Name' Text = role.Name });                      }                        return f;                  };
Magic Number,Coevery.Roles,RolesDataMigration,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Migrations.cs,Create,The following statement contains a magic number: return 2;
Magic Number,Coevery.Roles,RolesDataMigration,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Migrations.cs,UpdateFrom1,The following statement contains a magic number: return 2;
Magic Number,Coevery.Roles.Services,RolesBasedAuthorizationService,C:\repos\Coevery_Coevery\src\Coevery.Web\Modules\Coevery.Roles\Services\RolesBasedAuthorizationService.cs,TryCheckAccess,The following statement contains a magic number: for (var adjustmentLimiter = 0; adjustmentLimiter != 3; ++adjustmentLimiter) {                  if (!context.Granted && context.User != null) {                      if (!String.IsNullOrEmpty(_workContextAccessor.GetContext().CurrentSite.SuperUser) &&                             String.Equals(context.User.UserName' _workContextAccessor.GetContext().CurrentSite.SuperUser' StringComparison.Ordinal)) {                          context.Granted = true;                      }                  }                    if (!context.Granted) {                        // determine which set of permissions would satisfy the access check                      var grantingNames = PermissionNames(context.Permission' Enumerable.Empty<string>()).Distinct().ToArray();                        // determine what set of roles should be examined by the access check                      IEnumerable<string> rolesToExamine;                      if (context.User == null) {                          rolesToExamine = AnonymousRole;                      }                      else if (context.User.Has<IUserRoles>()) {                          // the current user is not null' so get his roles and add "Authenticated" to it                          rolesToExamine = context.User.As<IUserRoles>().Roles;                            // when it is a simulated anonymous user in the admin                          if (!rolesToExamine.Contains(AnonymousRole[0])) {                              rolesToExamine = rolesToExamine.Concat(AuthenticatedRole);                             }                      }                      else {                          // the user is not null and has no specific role' then it's just "Authenticated"                          rolesToExamine = AuthenticatedRole;                      }                        foreach (var role in rolesToExamine) {                          foreach (var permissionName in _roleService.GetPermissionsForRoleByName(role)) {                              string possessedName = permissionName;                              if (grantingNames.Any(grantingName => String.Equals(possessedName' grantingName' StringComparison.OrdinalIgnoreCase))) {                                  context.Granted = true;                              }                                if (context.Granted)                                  break;                          }                            if (context.Granted)                              break;                      }                  }                    context.Adjusted = false;                  _authorizationServiceEventHandler.Adjust(context);                  if (!context.Adjusted)                      break;              }
