Implementation smell,Namespace,Class,File,Method,Description
Complex Method,Pirate.Ldap.Web,GeneralPage,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\GeneralPage.cs,HandleLdapError,Cyclomatic complexity of the method is 8
Long Parameter List,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The method has 5 parameters.
Long Statement,Pirate.Ldap.Web,GeneralPage,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\GeneralPage.cs,HandleError,The length of the statement  "	BasicGlobal.LogAndReportError (exception' request' new Info ("Source"' PageName)' new Info ("Action"' action)' new Info ("User"' username)); " is 140.
Long Statement,Pirate.Ldap.Web,GeneralPage,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\GeneralPage.cs,HandleLdapError,The length of the statement  "		BasicGlobal.LogAndReportWarning (exception' Request' new Info ("Source"' PageName)' new Info ("Action"' action)' new Info ("User"' username)' new Info ("LdapResult"' ldapResult)); " is 179.
Long Statement,Pirate.Ldap.Web,GeneralPage,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\GeneralPage.cs,HandleLdapError,The length of the statement  "		BasicGlobal.LogAndReportError (exception' Request' new Info ("Source"' PageName)' new Info ("Action"' action)' new Info ("User"' username)' new Info ("LdapResult"' ldapResult)); " is 177.
Long Statement,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The length of the statement  "		var result = connection.Search (Names.Party' (int)LdapScope.Sub' new LdapAttributeFilter ("uid"' username).Text' new string[0]' false); " is 135.
Long Statement,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The length of the statement  "		BasicGlobal.Logger.Log (LogLevel.Info' "LDAP.Login sucessful for user {0} from IP {1}."' credentials.UserDn' clientIpAddress); " is 126.
Long Statement,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The length of the statement  "			BasicGlobal.Logger.Log (LogLevel.Info' "LDAP.Login failed. Invalid credentials for user {0} from IP {1}."' username' clientIpAddress); " is 134.
Long Statement,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The length of the statement  "			BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "Ldap.Login")' new Info ("Username"' username)' new Info ("LdapResult"' ldapResult)); " is 156.
Long Statement,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,TestLogin,The length of the statement  "		var result = connection.Search (Names.Party' (int)LdapScope.Sub' new LdapAttributeFilter ("uid"' username).Text' new string[0]' false); " is 135.
Long Statement,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,TestLogin,The length of the statement  "			BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "LDAP.TestLogin")' new Info ("Username"' username)' new Info ("LdapResult"' ldapResult)); " is 160.
Long Statement,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,TestLogin,The length of the statement  "		BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "Ldap.TestLogin")' new Info ("Username"' username)); " is 123.
Long Statement,Pirate.Ldap.Web,Mailer,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Mailer.cs,SendTextile,The length of the statement  "			BasicGlobal.Logger.Log (LogLevel.Error' "Cannot send mail with subject {0} to {1} because {2}"' subject' address' exception.ToString ()); " is 137.
Long Statement,Pirate.Ldap.Web,Mailer,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Mailer.cs,Send,The length of the statement  "			BasicGlobal.Logger.Log (LogLevel.Error' "Cannot send mail with subject {0} to {1} because {2}"' subject' address' exception.ToString ()); " is 137.
Long Statement,MemberService,GeneralHttpHandler,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\GeneralHttpHandler.cs,HandleError,The length of the statement  "	BasicGlobal.LogAndReportError (exception' context.Request' new Info ("Source"' SourceName)' new Info ("Action"' action)' new Info ("User"' username)); " is 150.
Long Statement,MemberService,GeneralHttpHandler,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\GeneralHttpHandler.cs,HandleLdapError,The length of the statement  "		BasicGlobal.LogAndReportWarning (exception' context.Request' new Info ("Source"' SourceName)' new Info ("Action"' action)' new Info ("User"' username)' new Info ("LdapResult"' ldapResult)); " is 189.
Long Statement,MemberService,GeneralHttpHandler,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\GeneralHttpHandler.cs,HandleLdapError,The length of the statement  "		BasicGlobal.LogAndReportError (exception' context.Request' new Info ("Source"' SourceName)' new Info ("Action"' action)' new Info ("User"' username)' new Info ("LdapResult"' ldapResult)); " is 187.
Magic Number,Pirate.Ldap.Web,BasicGlobal,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\BasicGlobal.cs,CheckRateLimit,The following statement contains a magic number: if (_rateLimitList.ContainsKey (key)) {  	var entry = _rateLimitList [key];  	if (DateTime.Now.Subtract (entry.FirstLogged).TotalMinutes >= 60) {  		if (entry.Count > 0) {  			infos.Add (new Info ("Limited since"' entry.FirstLogged));  			infos.Add (new Info ("Limited entries"' entry.Count));  		}  		entry.FirstLogged = DateTime.Now;  		entry.Count = 0;  		return true;  	}  	else {  		entry.Count++;  		return false;  	}  }  else {  	_rateLimitList.Add (key' new RateLimitEntry (key));  	return true;  }  
Magic Number,Pirate.Ldap.Web,BasicGlobal,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\BasicGlobal.cs,CheckRateLimit,The following statement contains a magic number: if (DateTime.Now.Subtract (entry.FirstLogged).TotalMinutes >= 60) {  	if (entry.Count > 0) {  		infos.Add (new Info ("Limited since"' entry.FirstLogged));  		infos.Add (new Info ("Limited entries"' entry.Count));  	}  	entry.FirstLogged = DateTime.Now;  	entry.Count = 0;  	return true;  }  else {  	entry.Count++;  	return false;  }  
Magic Number,Pirate.Ldap.Web,CredentionalObject,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\CredentionalObject.cs,CredentionalObject,The following statement contains a magic number: Expires = DateTime.Now.AddMinutes (30);  
Magic Number,Pirate.Ldap.Web,CredentionalObject,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\CredentionalObject.cs,Update,The following statement contains a magic number: Expires = DateTime.Now.AddMinutes (30);  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,GetKey,The following statement contains a magic number: if (key == null) {  	key = Crypto.GetRandom (32);  	application.Add (KeyObjectName' key);  }  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,GetKey,The following statement contains a magic number: key = Crypto.GetRandom (32);  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,GetBindConnection,The following statement contains a magic number: connection.Connect (config.LdapServer' 389);  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Connect,The following statement contains a magic number: try {  	var config = new Config.Config ();  	var key = GetKey (application);  	var data = session [CredentialsObjectName] as byte[];  	if (data == null) {  		BasicGlobal.Logger.Log (LogLevel.Info' "No LDAP credential object present at LDAP.Connect.");  		return null;  	}  	var plain = Crypto.Decrypt (key' data);  	var credentials = new CredentionalObject (plain);  	BasicGlobal.Logger.Log (LogLevel.Debug' "Ldap.Connect " + credentials.UserDn);  	if (DateTime.Now > credentials.Expires) {  		BasicGlobal.Logger.Log (LogLevel.Debug' "Ldap.Connect credentials expired for user {0}."' credentials.UserDn);  		return null;  	}  	credentials.Update ();  	var newPlain = credentials.ToBinary ();  	var newData = Crypto.Encrypt (key' newPlain);  	session.Remove (CredentialsObjectName);  	session.Add (CredentialsObjectName' newData);  	var connection = new LdapConnection ();  	connection.Connect (config.LdapServer' 389);  	connection.Bind (credentials.UserDn' credentials.Password);  	return new LdapAccess (connection);  }  catch (Exception exception) {  	BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "Ldap.Connect"));  	return null;  }  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Connect,The following statement contains a magic number: connection.Connect (config.LdapServer' 389);  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The following statement contains a magic number: connection.Connect (config.LdapServer' 389);  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The following statement contains a magic number: try {  	var result = connection.Search (Names.Party' (int)LdapScope.Sub' new LdapAttributeFilter ("uid"' username).Text' new string[0]' false);  	var user = result.next ();  	connection = new LdapConnection ();  	connection.Connect (config.LdapServer' 389);  	connection.Bind (user.DN' password);  	var key = GetKey (application);  	var credentials = new CredentionalObject (user.DN' password);  	var plain = credentials.ToBinary ();  	var data = Crypto.Encrypt (key' plain);  	session.Add (CredentialsObjectName' data);  	BasicGlobal.Logger.Log (LogLevel.Info' "LDAP.Login sucessful for user {0} from IP {1}."' credentials.UserDn' clientIpAddress);  	return true;  }  catch (LdapException exception) {  	var ldapResult = (LdapResultCode)exception.ResultCode;  	switch (ldapResult) {  	case LdapResultCode.LocalError:  		BasicGlobal.Logger.Log (LogLevel.Info' "LDAP.Login failed from IP {1}. No user named {0}."' username' clientIpAddress);  		break;  	case LdapResultCode.InvalidCredentials:  		BasicGlobal.Logger.Log (LogLevel.Info' "LDAP.Login failed. Invalid credentials for user {0} from IP {1}."' username' clientIpAddress);  		break;  	default:  		BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "Ldap.Login")' new Info ("Username"' username)' new Info ("LdapResult"' ldapResult));  		break;  	}  	return false;  }  catch (Exception exception) {  	BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "Ldap.Login")' new Info ("Username"' username));  	return false;  }  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,Login,The following statement contains a magic number: connection.Connect (config.LdapServer' 389);  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,TestLogin,The following statement contains a magic number: connection.Connect (config.LdapServer' 389);  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,TestLogin,The following statement contains a magic number: try {  	var result = connection.Search (Names.Party' (int)LdapScope.Sub' new LdapAttributeFilter ("uid"' username).Text' new string[0]' false);  	var user = result.next ();  	connection = new LdapConnection ();  	connection.Connect (config.LdapServer' 389);  	connection.Bind (user.DN' password);  	return true;  }  catch (LdapException exception) {  	var ldapResult = (LdapResultCode)exception.ResultCode;  	switch (ldapResult) {  	case LdapResultCode.LocalError:  		BasicGlobal.Logger.Log (LogLevel.Info' "LDAP.TestLogin failed. No user named {0}."' username);  		break;  	case LdapResultCode.InvalidCredentials:  		BasicGlobal.Logger.Log (LogLevel.Info' "LDAP.TestLogin failed. Invalid credentials for user {0}"' username);  		break;  	default:  		BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "LDAP.TestLogin")' new Info ("Username"' username)' new Info ("LdapResult"' ldapResult));  		break;  	}  	return false;  }  catch (Exception exception) {  	BasicGlobal.LogAndReportError (exception' request' new Info ("Action"' "Ldap.TestLogin")' new Info ("Username"' username));  	return false;  }  
Magic Number,Pirate.Ldap.Web,Ldap,C:\repos\ppschweiz_MemberDatabase\Organigram\Pirate.Ldap.Web\Ldap.cs,TestLogin,The following statement contains a magic number: connection.Connect (config.LdapServer' 389);  
