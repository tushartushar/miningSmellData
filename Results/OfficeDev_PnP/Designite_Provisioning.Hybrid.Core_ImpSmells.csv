Implementation smell,Namespace,Class,File,Method,Description
Long Method,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The method has 190 lines of code.
Complex Method,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,Cyclomatic complexity of the method is 9
Long Parameter List,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,GetNextSiteCollectionUrlTenant,The method has 7 parameters. Parameters: cc' web' ccSiteDirectory' webSiteDirectory' siteDirectoryUrl' siteDirectoryListName' baseSiteUrl
Long Parameter List,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,UpdateSiteDirectoryStatus,The method has 8 parameters. Parameters: cc' web' siteDirectoryHost' listName' siteUrl' newSiteUrl' status' ex
Long Parameter List,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,UpdateSiteDirectoryStatus,The method has 6 parameters. Parameters: cc' web' siteDirectoryHost' listName' siteUrl' status
Long Parameter List,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,UpdateSiteDirectoryStatus,The method has 7 parameters. Parameters: cc' web' siteDirectoryHost' listName' siteUrl' status' ex
Long Parameter List,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,UpdateSiteDirectoryStatus,The method has 7 parameters. Parameters: cc' web' siteDirectoryHost' listName' siteUrl' newSiteUrl' status
Long Parameter List,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,AddSiteDirectoryEntry,The method has 9 parameters. Parameters: cc' web' siteDirectoryHost' siteDirectoryProvisioningPage' listName' title' siteUrl' template' ownerLogins
Long Parameter List,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ISiteProvisioningOnPremises,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ISiteProvisioningOnPremises.cs,GetNextSiteCollectionUrl,The method has 5 parameters. Parameters: cc' web' siteDirectoryUrl' siteDirectoryListName' baseSiteUrl
Long Parameter List,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,AddPromotedSiteLink,The method has 5 parameters. Parameters: cc' web' listName' title' url
Long Identifier,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the parameter contosoCollaborationPromotedSiteName is 36.
Long Identifier,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the parameter contosoCollaborationPromotedSiteUrl is 35.
Long Statement,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,GetNextSiteCollectionUrlTenant,The length of the statement  "            int lastNumber = GetLastSiteCollectionNumber(ccSiteDirectory' webSiteDirectory' siteDirectoryUrl' siteDirectoryListName); " is 121.
Long Statement,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,GetLastSiteCollectionNumber,The length of the statement  "               + String.Format("<Where><Eq><FieldRef Name='CreateYear' /><Value Type='Int'>{0}</Value></Eq></Where>"' DateTime.Now.ToString("yyyy")) " is 133.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl); " is 137.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning"); " is 240.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList"); " is 329.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1); " is 153.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners"))); " is 167.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors"))); " is 171.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members"))); " is 169.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true); " is 147.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch); " is 226.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title); " is 143.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch); " is 252.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch); " is 200.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch); " is 207.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch); " is 227.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch); " is 198.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch); " is 202.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch); " is 208.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch); " is 213.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                    AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl); " is 158.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty); " is 168.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available"); " is 218.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts); " is 161.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody); " is 155.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The length of the statement  "                new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex); " is 244.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("			<type name=\"Microsoft.SharePoint.WebPartPages.XsltListViewWebPart' Microsoft.SharePoint' Version=15.0.0.0' Culture=neutral' PublicKeyToken=71e9bce111e9429c\" />"); " is 178.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append(String.Format("				<property name=\"ListId\" type=\"System.Guid' mscorlib' Version=4.0.0.0' Culture=neutral' PublicKeyToken=b77a5c561934e089\">{0}</property>"' listID.ToString())); " is 190.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("				<property name=\"ViewFlags\" type=\"Microsoft.SharePoint.SPViewFlags' Microsoft.SharePoint' Version=15.0.0.0' Culture=neutral' PublicKeyToken=71e9bce111e9429c\">None</property>"); " is 194.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append(String.Format("				<property name=\"ListName\" type=\"string\">{0}</property>"' ("{" + listID.ToString().ToUpper() + "}"))); " is 134.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("				<property name=\"CatalogIconImageUrl\" type=\"string\">/_layouts/15/images/itgen.png?rev=26</property>"); " is 120.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("				<property name=\"PageType\" type=\"Microsoft.SharePoint.PAGETYPE' Microsoft.SharePoint' Version=15.0.0.0' Culture=neutral' PublicKeyToken=71e9bce111e9429c\">PAGE_NORMALVIEW</property>"); " is 201.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("				<property name=\"WebId\" type=\"System.Guid' mscorlib' Version=4.0.0.0' Culture=neutral' PublicKeyToken=b77a5c561934e089\">00000000-0000-0000-0000-000000000000</property>"); " is 188.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append(string.Format("&lt;View Name=\"{1}\" Type=\"HTML\" Hidden=\"TRUE\" ReadOnly=\"TRUE\" OrderedView=\"TRUE\" DisplayName=\"\" Url=\"{0}\" Level=\"1\" BaseViewID=\"1\" ContentTypeID=\"0x\" &gt;&lt;Query&gt;&lt;OrderBy&gt;&lt;FieldRef Name=\"TileOrder\" Ascending=\"TRUE\"/&gt;&lt;FieldRef Name=\"Modified\" Ascending=\"FALSE\"/&gt;&lt;/OrderBy&gt;&lt;/Query&gt;&lt;ViewFields&gt;&lt;FieldRef Name=\"Title\"/&gt;&lt;FieldRef Name=\"BackgroundImageLocation\"/&gt;&lt;FieldRef Name=\"Description\"/&gt;&lt;FieldRef Name=\"LinkLocation\"/&gt;&lt;FieldRef Name=\"LaunchBehavior\"/&gt;&lt;FieldRef Name=\"BackgroundImageClusterX\"/&gt;&lt;FieldRef Name=\"BackgroundImageClusterY\"/&gt;&lt;/ViewFields&gt;&lt;RowLimit Paged=\"TRUE\"&gt;30&lt;/RowLimit&gt;&lt;JSLink&gt;sp.ui.tileview.js&lt;/JSLink&gt;&lt;XslLink Default=\"TRUE\"&gt;main.xsl&lt;/XslLink&gt;&lt;Toolbar Type=\"Standard\"/&gt;&lt;/View&gt;</property>"' pageUrl' ("{" + Guid.NewGuid().ToString() + "}"))); " is 968.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("            &lt;ParameterBinding Name=\"OpenMenuKeyAccessible\" Location=\"Resource(wss'OpenMenuKeyAccessible)\" /&gt;"); " is 132.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("            &lt;ParameterBinding Name=\"select_deselect_all\" Location=\"Resource(wss'select_deselect_all)\" /&gt;"); " is 128.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("            &lt;ParameterBinding Name=\"idPresEnabled\" Location=\"Resource(wss'idPresEnabled)\" /&gt;&lt;ParameterBinding Name=\"NoAnnouncements\" Location=\"Resource(wss'noXinviewofY_LIST)\" /&gt;&lt;ParameterBinding Name=\"NoAnnouncementsHowTo\" Location=\"Resource(wss'noXinviewofY_DEFAULT)\" /&gt;</property>"); " is 327.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The length of the statement  "            wp.Append("				<property name=\"DataSourceMode\" type=\"Microsoft.SharePoint.WebControls.SPDataSourceMode' Microsoft.SharePoint' Version=15.0.0.0' Culture=neutral' PublicKeyToken=71e9bce111e9429c\">List</property>"); " is 216.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpSiteUsers,The length of the statement  "            sb.Append("<WebPart xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://schemas.microsoft.com/WebPart/v2\">"); " is 176.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpSiteUsers,The length of the statement  "            sb.Append("	<Description>Use the Site Users Web Part to see a list of the site users and their online status.</Description>"); " is 126.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpSiteUsers,The length of the statement  "            sb.Append("	<Assembly>Microsoft.SharePoint' Version=15.0.0.0' Culture=neutral' PublicKeyToken=71e9bce111e9429c</Assembly>"); " is 124.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpSiteUsers,The length of the statement  "            sb.Append(string.Format("	<MembershipGroupId xmlns=\"http://schemas.microsoft.com/WebPart/v2/Members\">{0}</MembershipGroupId>"' groupID)); " is 139.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The length of the statement  "                SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl); " is 137.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The length of the statement  "                siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning"); " is 240.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The length of the statement  "                siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available"); " is 218.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The length of the statement  "                string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts); " is 161.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The length of the statement  "                MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody); " is 155.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The length of the statement  "                new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex); " is 244.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,SiteProvisioningBase,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\SiteProvisioningBase.cs,InstantiateAppOnlyClientContext,The length of the statement  "            this.appOnlyClientContext = new AuthenticationManager().GetAppOnlyAuthenticatedContext(siteUrl' this.Realm' this.AppId' this.AppSecret); " is 136.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,SiteProvisioningBase,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\SiteProvisioningBase.cs,InstantiateCreatedSiteClientContext,The length of the statement  "            this.createdSiteContext = new AuthenticationManager().GetAppOnlyAuthenticatedContext(siteUrl' this.Realm' this.AppId' this.AppSecret); " is 134.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,SiteProvisioningBase,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\SiteProvisioningBase.cs,InstantiateSiteDirectorySiteClientContext,The length of the statement  "            this.siteDirectorySiteContext = new AuthenticationManager().GetAppOnlyAuthenticatedContext(siteUrl' this.Realm' this.AppId' this.AppSecret); " is 140.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,SiteProvisioningBase,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\SiteProvisioningBase.cs,GetNextSiteCollectionUrl,The length of the statement  "                return this.SiteProvisioningOnPremises.GetNextSiteCollectionUrl(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' siteDirectoryUrl' siteDirectoryListName' baseSiteUrl); " is 184.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,SiteProvisioningBase,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\SiteProvisioningBase.cs,GetNextSiteCollectionUrl,The length of the statement  "                return new SiteDirectoryManager().GetNextSiteCollectionUrlTenant(this.AppOnlyClientContext' this.AppOnlyClientContext.Web' this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' siteDirectoryUrl' siteDirectoryListName' baseSiteUrl); " is 243.
Long Statement,Contoso.Provisioning.Hybrid.Core.SiteTemplates,SiteProvisioningBase,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\SiteProvisioningBase.cs,AddSiteCollection,The length of the statement  "                this.createdSiteContext = this.SiteProvisioningOnPremises.SpOnPremiseAuthentication(this.SharePointProvisioningData.Url); " is 121.
Magic Number,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,GetCreationYear,The following statement contains a magic number: if (int.TryParse(lastWord.Substring(0' 4)' out result))              {                  return result;              }
Magic Number,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,GetCreationSequence,The following statement contains a magic number: if (int.TryParse(lastWord.Substring(4' 4)' out result))              {                  return result;              }
Magic Number,Contoso.Provisioning.Hybrid.Core,SiteDirectoryManager,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteDirectoryManager.cs,GetCreationSequence,The following statement contains a magic number: if (int.TryParse(lastWord.Substring(4' 4)' out result))              {                  return result;              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                  //FeatureManager featureManager = new FeatureManager();                  //ListManager listManager = new ListManager();                  //PageManager pageManager = new PageManager();                  //SecurityManager securityManager = new SecurityManager();                  //NavigationManager navigationManager = new NavigationManager();                  //BrandingManager brandingManager = new BrandingManager();                      string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "STS#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    //enable features                  // Document ID Service (DocID) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("b50e3104-6812-424f-a011-cc90e6327318"));                  // Search Server Web Parts and Templates (SearchMaster) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("9c0834e1-ba47-4d49-812b-7d4fb6fea211"));                  // Workflows (Workflows) site collection feature                  this.CreatedSiteContext.Site.ActivateFeature(new Guid("0af5989a-3aea-4519-8ab0-85d91abe39ff"));                  // Metadata Navigation and Filtering (MetaDataNav) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("7201d6a4-a5d3-49a1-8c19-19c4bac6e668"));                  // Community Site Feature (CommunitySite) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("961d6a9c-4388-4cf2-9733-38ee8c89afd4"));                  // Project Functionality (ProjectFunctionality) site feature                  this.CreatedSiteContext.Web.ActivateFeature(new Guid("e2f2bb18-891d-4812-97df-c265afdba297"));                    // Picture library called Media                  this.CreatedSiteContext.Web.CreateList(Microsoft.SharePoint.Client.ListTemplateType.PictureLibrary' "Media"' false);                  // Promoted Links library called Links                  this.CreatedSiteContext.Web.CreateList(new Guid("192efa95-e50c-475e-87ab-361cede5dd7f")' 170' "Links"' false);                    // Update existing list settings for the documents library and the blog post library                  this.CreatedSiteContext.Web.UpdateListVersioning("Documents"' true);                    //Remove the "Project Summary" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Project Summary"' "home.aspx");                  //Remove the "Get started with your site" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Get started with your site"' "home.aspx");                  //Remove the "Documents" web part                  this.CreatedSiteContext.Web.DeleteWebPart("SitePages"' "Documents"' "home.aspx");                    //Add links web part to the home page                  Guid linksID = this.CreatedSiteContext.Web.GetListID("Links");                  WebPartEntity promotedLinksWP = new WebPartEntity();                  promotedLinksWP.WebPartXml = WpPromotedLinks(linksID' string.Format("{0}{1}/Lists/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "Links")' string.Format("{0}{1}/SitePages/{2}"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Name' "home.aspx")' "$Resources:core'linksList");                  promotedLinksWP.WebPartIndex = 2;                  promotedLinksWP.WebPartTitle = "Links";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' promotedLinksWP' "home.aspx"' 2' 2' false);                    //Add html to the home page wiki                  this.CreatedSiteContext.Web.AddHtmlToWikiPage("SitePages"' "Hello <strong>SharePoint Conference</strong> from spc403<br/><br/><br/>"' "home.aspx"' 1' 1);                    //add additional pages                  string siteMembersPage = "site members.aspx";                  string siteMembersUrl = this.CreatedSiteContext.Web.AddWikiPage("Site Pages"' siteMembersPage);                  this.CreatedSiteContext.Web.AddLayoutToWikiPage("SitePages"' WikiPageLayout.TwoColumns' siteMembersPage);                  //Add site members web parts                  WebPartEntity wpSiteUsers = new WebPartEntity();                  wpSiteUsers.WebPartXml = WpSiteUsers("Site owners"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Owners")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site owners";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' false);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site visitors"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Visitors")));                  wpSiteUsers.WebPartIndex = 1;                  wpSiteUsers.WebPartTitle = "Site visitors";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 1' true);                    wpSiteUsers.WebPartXml = WpSiteUsers("Site members"' this.CreatedSiteContext.Web.GetGroupID(String.Format("{0} {1}"' this.SharePointProvisioningData.Title' "Members")));                  wpSiteUsers.WebPartIndex = 0;                  wpSiteUsers.WebPartTitle = "Site members";                  this.CreatedSiteContext.Web.AddWebPartToWikiPage("SitePages"' wpSiteUsers' siteMembersPage' 1' 2' false);                    //Update the quick launch navigation                  //First delete all quicklaunch entries                  this.CreatedSiteContext.Web.DeleteAllQuickLaunchNodes();                    this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'nav_Home"' null' ""' NavigationType.QuickLaunch);                  //csomService.AddNavigationNode(this.SiteToProvision' "$Resources:core'BlogQuickLaunchTitle"' new Uri(this.BlogSite.Url)' "News & Trending"' true);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'DiscussionsTab"' new Uri(string.Format("{0}/Lists/Community%20Discussion/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  string notebookPath = string.Format("{0}/SiteAssets/{1} Notebook"' this.SharePointProvisioningData.Url' this.SharePointProvisioningData.Title);                  notebookPath = HttpUtility.UrlPathEncode(notebookPath' false).Replace("/"' "%2F");                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'SiteNotebookLink"' new Uri(string.Format("{0}/_layouts/15/WopiFrame.aspx?sourcedoc={1}&action=editnew"' this.SharePointProvisioningData.Url' notebookPath))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'taskList"' new Uri(string.Format("{0}/Lists/Tasks/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'calendarList"' new Uri(string.Format("{0}/Lists/Calendar/calendar.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'shareddocuments_Title_15"' new Uri(string.Format("{0}/Shared Documents/Forms/AllItems.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'linksList"' new Uri(string.Format("{0}/Lists/Links/Tiles.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'GrpMedia"' new Uri(string.Format("{0}/Media/Forms/Thumbnails.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:spscore'Members_QuickLaunch"' new Uri(string.Format("{0}/{1}"' this.SharePointProvisioningData.Url' siteMembersUrl))' ""' NavigationType.QuickLaunch);                  this.CreatedSiteContext.Web.AddNavigationNode("$Resources:core'category_SiteContents"' new Uri(string.Format("{0}/_layouts/15/viewlsts.aspx"' this.SharePointProvisioningData.Url))' ""' NavigationType.QuickLaunch);                    // Insert demo promoted links list item                  if (contosoCollaborationPromotedSiteName.Length > 0 || contosoCollaborationPromotedSiteUrl.Length > 0)                  {                      AddPromotedSiteLink(this.CreatedSiteContext' this.CreatedSiteContext.Web' "Links"' contosoCollaborationPromotedSiteName' contosoCollaborationPromotedSiteUrl);                  }                    if (!this.CreateOnPremises)                  {                      // add owners to site collection administrators                      List<UserEntity> adminLogins = new List<UserEntity>();                        int i = 0;                      foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                      {                          adminLogins.Add(new UserEntity()                              {                                   Email = owner.Email'                                   LoginName = owner.Login'                                   Title = owner.Name'                              });                          i++;                      }                        Tenant tenant = new Tenant(this.AppOnlyClientContext);                      tenant.AddAdministrators(adminLogins' new Uri(this.SharePointProvisioningData.Url)' true);                        // Everyone reader                      this.CreatedSiteContext.Web.AddReaderAccess();                  }                    // Apply themes                  string themeRoot = Path.Combine(this.AppRootPath' String.Format(@"Themes\{0}"' contosoCollaborationThemeName));                  string spColorFile = Path.Combine(themeRoot' string.Format("{0}.spcolor"' contosoCollaborationThemeName));                  string spFontFile = Path.Combine(themeRoot' string.Format("{0}.spfont"' contosoCollaborationThemeName));                  string backgroundFile = Path.Combine(themeRoot' string.Format("{0}bg.jpg"' contosoCollaborationThemeName));                  string logoFile = Path.Combine(themeRoot' string.Format("{0}logo.png"' contosoCollaborationThemeName));                    // Deploy theme files to root web' if they are not there and set it as active theme for the site                  string themeColorFileString = "";                  string themeFontFileString = "";                  string themeBackgroundImageString = "";                    if (!String.IsNullOrEmpty(themeRoot))                  {                      themeColorFileString = this.CreatedSiteContext.Web.UploadThemeFile(themeRoot).ServerRelativeUrl;                    }                  if (!String.IsNullOrEmpty(spColorFile))                  {                      themeFontFileString = this.CreatedSiteContext.Web.UploadThemeFile(spColorFile).ServerRelativeUrl;                  }                    if (!String.IsNullOrWhiteSpace(backgroundFile))                  {                      themeBackgroundImageString = this.CreatedSiteContext.Web.UploadThemeFile(backgroundFile).ServerRelativeUrl;                  }                    this.CreatedSiteContext.Web.CreateComposedLookByUrl(contosoCollaborationThemeName' themeColorFileString' themeFontFileString' themeBackgroundImageString' String.Empty);                  this.CreatedSiteContext.Web.SetComposedLookByUrl(contosoCollaborationThemeName);                    //Seems to be broken at the moment...to be investigated                  //brandingManager.SetSiteLogo(this.CreatedSiteContext' this.CreatedSiteContext.Web' logoFile);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);                }              catch (Exception ex)              {                  //log error                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpPromotedLinks,The following statement contains a magic number: StringBuilder wp = new StringBuilder(100);
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoCollaboration,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoCollaboration.cs,WpSiteUsers,The following statement contains a magic number: StringBuilder sb = new StringBuilder(25);
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                    string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "PROJECTSITE#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);              }              catch (Exception ex)              {                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                    string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "PROJECTSITE#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);              }              catch (Exception ex)              {                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                    string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "PROJECTSITE#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);              }              catch (Exception ex)              {                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
Magic Number,Contoso.Provisioning.Hybrid.Core.SiteTemplates,ContosoProject,C:\repos\OfficeDev_PnP\Solutions\Provisioning.Hybrid\Provisioning.Hybrid.Core\SiteTemplates\ContosoProject.cs,Execute,The following statement contains a magic number: try              {                  SiteDirectoryManager siteDirectoryManager = new SiteDirectoryManager();                    string tempSharePointUrl = this.SharePointProvisioningData.Url;                  string siteCollectionUrl = this.CreateOnPremises ? generalOnPremWebApplication : generalSiteCollectionUrl;                    // issue the final SharePoint url                  SharePointProvisioningData.Url = this.GetNextSiteCollectionUrl(generalSiteDirectoryUrl' generalSiteDirectoryListName' siteCollectionUrl);                    //update site directory status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' tempSharePointUrl' this.SharePointProvisioningData.Url' "Provisioning");                    //complete the site data                  this.SharePointProvisioningData.Template = "PROJECTSITE#0";                  this.SharePointProvisioningData.SiteOwner = this.SharePointProvisioningData.Owners[0];                  this.SharePointProvisioningData.Lcid = 1033;                  this.SharePointProvisioningData.TimeZoneId = 3;                  this.SharePointProvisioningData.StorageMaximumLevel = 100;                  this.SharePointProvisioningData.StorageWarningLevel = 80;                    //create the site collection                  this.AddSiteCollection(this.SharePointProvisioningData);                    // Update status                  siteDirectoryManager.UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Available");                    // Send mail to owners                  List<String> mailTo = new List<string>();                  string ownerNames = "";                  string ownerAccounts = "";                    foreach (SharePointUser owner in this.SharePointProvisioningData.Owners)                  {                      mailTo.Add(owner.Email);                        if (ownerNames.Length > 0)                      {                          ownerNames = ownerNames + "' ";                          ownerAccounts = ownerAccounts + "' ";                      }                      ownerNames = ownerNames + owner.Name;                      ownerAccounts = ownerAccounts + owner.Login;                  }                    // send email to notify the use of successful provisioning                  string mailBody = String.Format(generalMailSiteAvailable' this.SharePointProvisioningData.Title' this.SharePointProvisioningData.Url' ownerNames' ownerAccounts);                  MailUtility.SendEmail(generalMailSMTPServer' generalMailUser' generalMailUserPassword' mailTo' null' "Your SharePoint site is ready to be used"' mailBody);              }              catch (Exception ex)              {                  new SiteDirectoryManager().UpdateSiteDirectoryStatus(this.SiteDirectorySiteContext' this.SiteDirectorySiteContext.Web' generalSiteDirectoryUrl' generalSiteDirectoryListName' this.SharePointProvisioningData.Url' "Error during provisioning"' ex);              }
