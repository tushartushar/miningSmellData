Implementation smell,Namespace,Class,File,Method,Description
Long Method,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The method has 170 lines of code.
Long Parameter List,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The method has 6 parameters. Parameters: producer' mode' batchSize' messageCount' topic' payload
Long Statement,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,InitializeEQueue,The length of the statement  "                    _logger.InfoFormat("{0}' {1}' totalCount: {2}' throughput: {3}' averageThrughput: {4}' rt: {5:F3}ms' averageRT: {6:F3}ms"' _performanceService.Name' logContextText' x.TotalCount' x.Throughput' x.AverageThroughput' x.RT' x.AverageRT); " is 233.
Long Statement,QuickStart.ProducerClient,ResponseHandler,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,HandleResponse,The length of the statement  "                    _performanceService.IncrementKeyCount(_mode' (DateTime.Now - sendResult.MessageStoreResult.CreatedTime).TotalMilliseconds); " is 123.
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessageTest,The following statement contains a magic number: for (var i = 0; i < clientCount; i++)              {                  var setting = new ProducerSetting                  {                      ClusterName = clusterName'                      NameServerList = new List<IPEndPoint> { new IPEndPoint(nameServerAddress' 9493) }                  };                  var producer = new Producer(setting);                  if (_mode == "Callback")                  {                      producer.RegisterResponseHandler(new ResponseHandler { BatchSize = batchSize });                  }                  producer.Start();                  actions.Add(() => SendMessages(producer' _mode' batchSize' messageCount' topic' payload));              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: if (_mode == "Oneway")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendOneway(message' index.ToString());                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendOneway(messages' index.ToString());                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Sync")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          var result = producer.Send(message' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          var result = producer.BatchSend(messages' index.ToString());                          if (result.SendStatus != SendStatus.Success)                          {                              throw new Exception(result.ErrorMessage);                          }                          var currentTime = DateTime.Now;                          foreach (var message in messages)                          {                              _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                          }                      }                  };              }              else if (_mode == "Async")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendAsync(message' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              _performanceService.IncrementKeyCount(_mode' (DateTime.Now - message.CreatedTime).TotalMilliseconds);                          });                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendAsync(messages' index.ToString()).ContinueWith(t =>                          {                              if (t.Exception != null)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message has exception' errorMessage: {0}"' t.Exception.GetBaseException().Message);                                  return;                              }                              if (t.Result == null)                              {                                  _hasError = true;                                  _logger.Error("Send message timeout.");                                  return;                              }                              if (t.Result.SendStatus != SendStatus.Success)                              {                                  _hasError = true;                                  _logger.ErrorFormat("Send message failed' errorMessage: {0}"' t.Result.ErrorMessage);                                  return;                              }                              var currentTime = DateTime.Now;                              foreach (var message in messages)                              {                                  _performanceService.IncrementKeyCount(_mode' (currentTime - message.CreatedTime).TotalMilliseconds);                              }                          });                      }                  };              }              else if (_mode == "Callback")              {                  sendAction = index =>                  {                      if (batchSize == 1)                      {                          var message = new Message(topic' 100' payload);                          producer.SendWithCallback(message' index.ToString());                      }                      else                      {                          var messages = new List<Message>();                          for (var i = 0; i < batchSize; i++)                          {                              messages.Add(new Message(topic' 100' payload));                          }                          producer.BatchSendWithCallback(messages' index.ToString());                      }                  };              }
Magic Number,QuickStart.ProducerClient,Program,C:\repos\tangxuehua_equeue\src\Samples\QuickStart\QuickStart.ProducerClient\Program.cs,SendMessages,The following statement contains a magic number: Task.Factory.StartNew(() =>              {                  for (var i = 0L; i < messageCount; i++)                  {                      try                      {                          sendAction(i);                      }                      catch (Exception ex)                      {                          _hasError = true;                          _logger.ErrorFormat("Send message failed' errorMsg:{0}"' ex.Message);                      }                        if (_hasError)                      {                          Thread.Sleep(3000);                          _hasError = false;                      }                  }              });
