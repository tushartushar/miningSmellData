Implementation smell,Namespace,Class,File,Method,Description
Long Parameter List,Loyc,CustomToolBase,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\CustomToolBase.cs,Generate,The method has 6 parameters. Parameters: inputFilePath' inputFileContents' defaultNamespace' outputFileContents' outputSize' progressCallback
Long Parameter List,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,RegisterSingleFileGenerators,The method has 5 parameters. Parameters: sink' assembly' rootKey' generatorsKey' unregister
Long Parameter List,SingleFileGenerator,VSType,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,VSType,The method has 6 parameters. Parameters: name' versionNumber' registryPath' registryPath2' pro' language
Long Parameter List,SingleFileGenerator,LeMPCustomTool,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\LoycCustomTools.cs,ReportErrorToVS,The method has 5 parameters. Parameters: generatorProgress' severity' context' message' args
Long Parameter List,Loyc.VisualStudio,LeMPCustomTool,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\LoycCustomTools.cs,ReportErrorToVS,The method has 5 parameters. Parameters: generatorProgress' severity' context' message' args
Long Identifier,Microsoft.VisualStudio.Shell,CodeGeneratorRegistrationAttribute,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\CodeGeneratorRegistrationAttribute.cs,,The length of the parameter _generatesSharedDesignTimeSource is 32.
Long Statement,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The length of the statement  "			System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(InstallForm));" is 131.
Long Statement,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The length of the statement  "			this.listVisualStudios.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) " is 153.
Long Statement,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The length of the statement  "			this.btnRegister.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));" is 150.
Long Statement,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The length of the statement  "			this.btnUnregister.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));" is 152.
Long Statement,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The length of the statement  "			this.label2.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left) " is 142.
Empty Catch Block,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,RegisterSingleFileGenerators,The method has an empty catch block.
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InstallForm_Load,The following statement contains a magic number: foreach (VSType vs in VSType.VSEditions.Where(t => t.VersionNumber >= 8.0)) { 				string path' path_norm = vs.RegistryPath' path_wow = PathForWow64(path_norm); 				string path2' path2_norm = vs.RegistryPath2' path2_wow = PathForWow64(path2_norm); 				RegistryKey key = Registry.LocalMachine.OpenSubKey(path = Path.Combine(path_wow' "Generators")' false) 				               ?? Registry.LocalMachine.OpenSubKey(path = Path.Combine(path_norm' "Generators")' false); 				RegistryKey key2 = Registry.CurrentUser.OpenSubKey(path2 = Path.Combine(path2_wow' "Generators")' false) 							    ?? Registry.CurrentUser.OpenSubKey(path2 = Path.Combine(path2_norm' "Generators")' false); 				if (key != null || key2 != null) 					using (key) { 						var lvi = new ListViewItem(vs.Name); 						lvi.SubItems.Add("{HKLM}\\" + path); 						lvi.SubItems.Add("{HKCU}\\" + path2); 						lvi.Checked = true; 						listVisualStudios.Items.Add(lvi); 					} 			}
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,PathForWow64,The following statement contains a magic number: if (IntPtr.Size == 8) 				return path.Insert("SOFTWARE\\".Length' "Wow6432Node\\"); 			else 				return path;
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,RegisterOrUnregister,The following statement contains a magic number: foreach (ListViewItem lvi in listVisualStudios.Items) { 				if (lvi.Checked) { 					var normalHive = lvi.SubItems[1].Text.Replace("{HKLM}\\"' ""); 					var liveHive   = lvi.SubItems[2].Text.Replace("{HKCU}\\"' ""); 					if (RegisterSingleFileGenerators(sink' _sfgAssembly' Registry.LocalMachine' normalHive' unregister)) 						count++; 					if (!string.IsNullOrEmpty(liveHive)) 						RegisterSingleFileGenerators(sink' _sfgAssembly' Registry.CurrentUser' liveHive' unregister); 				} 			}
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.listVisualStudios.Location = new System.Drawing.Point(12' 35);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.listVisualStudios.Location = new System.Drawing.Point(12' 35);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.listVisualStudios.Size = new System.Drawing.Size(600' 155);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.listVisualStudios.Size = new System.Drawing.Size(600' 155);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.columnHeader1.Width = 181;
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.columnHeader2.Width = 375;
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label1.Location = new System.Drawing.Point(12' 9);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label1.Location = new System.Drawing.Point(12' 9);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label1.Size = new System.Drawing.Size(182' 13);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label1.Size = new System.Drawing.Size(182' 13);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnRegister.Location = new System.Drawing.Point(486' 196);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnRegister.Location = new System.Drawing.Point(486' 196);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnRegister.Size = new System.Drawing.Size(126' 42);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnRegister.Size = new System.Drawing.Size(126' 42);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnRegister.TabIndex = 4;
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnUnregister.Location = new System.Drawing.Point(486' 244);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnUnregister.Location = new System.Drawing.Point(486' 244);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnUnregister.Size = new System.Drawing.Size(126' 32);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnUnregister.Size = new System.Drawing.Size(126' 32);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.btnUnregister.TabIndex = 4;
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label2.Location = new System.Drawing.Point(12' 196);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label2.Location = new System.Drawing.Point(12' 196);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label2.Size = new System.Drawing.Size(457' 86);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label2.Size = new System.Drawing.Size(457' 86);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.label2.TabIndex = 5;
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.ClientSize = new System.Drawing.Size(624' 288);
Magic Number,SingleFileGenerator,InstallForm,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\InstallForm.cs,InitializeComponent,The following statement contains a magic number: this.ClientSize = new System.Drawing.Size(624' 288);
Magic Number,SingleFileGenerator,LeMPCustomTool,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\LoycCustomTools.cs,Generate,The following statement contains a magic number: try { 				string inputFolder = Path.GetDirectoryName(inputFilePath);  				Environment.CurrentDirectory = inputFolder; // --macros should be relative to file being processed  				// Originally I wrote a conversion from IVsGeneratorProgress to  				// IMessageSink so that errors could be reported immediately and 				// directly to Visual Studio. This broke in a bizarre way when I 				// added processing on a separate thread (in order to be able to 				// abort the thread if it runs too long); I got the following 				// InvalidCastException: "Unable to cast COM object of type 'System.__ComObject'  				// to interface type 'Microsoft.VisualStudio.Shell.Interop.IVsGeneratorProgress'. 				// This operation failed because the QueryInterface call on the COM component for  				// the interface with IID '{BED89B98-6EC9-43CB-B0A8-41D6E2D6669D}' failed due to  				// the following error: No such interface supported (Exception from HRESULT:  				// 0x80004002 (E_NOINTERFACE))." 				//  				// A simple solution is to store the messages rather than reporting 				// them immediately. I'll report the errors at the very end. 				MessageHolder sink = new MessageHolder(); 				 				var sourceFile = new InputOutput((UString)inputFileContents' inputFilePath);  				Compiler.KnownOptions["no-out-header"] = Pair.Create(""' "Remove explanatory comment from output file"); 				Compiler.KnownOptions.Remove("parallel");   // not applicable to single file 				Compiler.KnownOptions.Remove("noparallel"); // not applicable to single file  				var c = new Compiler(sink' sourceFile) {  					AbortTimeout = TimeSpan.FromSeconds(10)' 					Parallel = false // only one file' parallel doesn't help 				};  				var argList = G.SplitCommandLineArguments(defaultNamespace); 				var options = c.ProcessArguments(argList' true' false); 				// Note: if default namespace is left blank' VS uses the namespace  				// from project settings. Don't show an error in that case. 				if (argList.Count > 1 || (argList.Count == 1 && options.Count > 0)) 					sink.Write(Severity.Error' "Command line"' "'{0}': expected options only (try --help)."' argList[0]);  				string _; 				if (options.TryGetValue("help"' out _) || options.TryGetValue("?"' out _)) 				{ 					var ms = new MemoryStream(); 					LeMP.Compiler.ShowHelp(LeMP.Compiler.KnownOptions' new StreamWriter(ms)' false); 					return ms.GetBuffer(); 				}  				LeMP.Compiler.WarnAboutUnknownOptions(options' sink' LeMP.Compiler.KnownOptions); 				 				if (options.ContainsKey("no-out-header")) 					c.NoOutHeader = true; 				 				if (c.InLang == LesLanguageService.Value || inputFilePath.EndsWith(".les"' StringComparison.OrdinalIgnoreCase)) 					c.MacroProcessor.PreOpenedNamespaces.Add(GSymbol.Get("LeMP.Prelude.Les")); 						 				Configure(c); 				_requestedExtension = c.OutExt; 				c.Run();  				// Report errors 				foreach (var msg in sink.List) 					ReportErrorToVS(progressCallback' msg.Severity' msg.Context' msg.Format' msg.Args);  				return Encoding.UTF8.GetBytes(c.Output.ToString()); 			} finally { 				Environment.CurrentDirectory = oldCurDir; 			}
Magic Number,SingleFileGenerator,LeMPCustomTool,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\LoycCustomTools.cs,ReportErrorToVS,The following statement contains a magic number: int n = subwarning ? 2 : severity == Severity.Warning ? 1 : 0;
Magic Number,Loyc.VisualStudio,LeMPCustomTool,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\LoycCustomTools.cs,Generate,The following statement contains a magic number: try { 				string inputFolder = Path.GetDirectoryName(inputFilePath);  				Environment.CurrentDirectory = inputFolder; // --macros should be relative to file being processed  				// Originally I wrote a conversion from IVsGeneratorProgress to  				// IMessageSink so that errors could be reported immediately and 				// directly to Visual Studio. This broke in a bizarre way when I 				// added processing on a separate thread (in order to be able to 				// abort the thread if it runs too long); I got the following 				// InvalidCastException: "Unable to cast COM object of type 'System.__ComObject'  				// to interface type 'Microsoft.VisualStudio.Shell.Interop.IVsGeneratorProgress'. 				// This operation failed because the QueryInterface call on the COM component for  				// the interface with IID '{BED89B98-6EC9-43CB-B0A8-41D6E2D6669D}' failed due to  				// the following error: No such interface supported (Exception from HRESULT:  				// 0x80004002 (E_NOINTERFACE))." 				//  				// A simple solution is to store the messages rather than reporting 				// them immediately. I'll report the errors at the very end. 				MessageHolder sink = new MessageHolder(); 				 				var sourceFile = new InputOutput((UString)inputFileContents' inputFilePath);  				Compiler.KnownOptions["no-out-header"] = Pair.Create(""' "Remove explanatory comment from output file"); 				Compiler.KnownOptions.Remove("parallel");   // not applicable to single file 				Compiler.KnownOptions.Remove("noparallel"); // not applicable to single file  				var c = new Compiler(sink' sourceFile) {  					AbortTimeout = TimeSpan.FromSeconds(10)' 					Parallel = false // only one file' parallel doesn't help 				};  				var argList = G.SplitCommandLineArguments(defaultNamespace); 				var options = c.ProcessArguments(argList' true' false); 				// Note: if default namespace is left blank' VS uses the namespace  				// from project settings. Don't show an error in that case. 				if (argList.Count > 1 || (argList.Count == 1 && options.Count > 0)) 					sink.Write(Severity.Error' "Command line"' "'{0}': expected options only (try --help)."' argList[0]);  				string _; 				if (options.TryGetValue("help"' out _) || options.TryGetValue("?"' out _)) 				{ 					var ms = new MemoryStream(); 					LeMP.Compiler.ShowHelp(LeMP.Compiler.KnownOptions' new StreamWriter(ms)' false); 					return ms.GetBuffer(); 				}  				LeMP.Compiler.WarnAboutUnknownOptions(options' sink' LeMP.Compiler.KnownOptions); 				 				if (options.ContainsKey("no-out-header")) 					c.NoOutHeader = true; 				 				if (c.InLang == LesLanguageService.Value || inputFilePath.EndsWith(".les"' StringComparison.OrdinalIgnoreCase)) 					c.MacroProcessor.PreOpenedNamespaces.Add(GSymbol.Get("LeMP.Prelude.Les")); 						 				Configure(c); 				_requestedExtension = c.OutExt; 				c.Run();  				// Report errors 				foreach (var msg in sink.List) 					ReportErrorToVS(progressCallback' msg.Severity' msg.Context' msg.Format' msg.Args);  				return Encoding.UTF8.GetBytes(c.Output.ToString()); 			} finally { 				Environment.CurrentDirectory = oldCurDir; 			}
Magic Number,Loyc.VisualStudio,LeMPCustomTool,C:\repos\qwertie_Loyc\Visual Studio Integration\LoycFileGeneratorForVs\LoycCustomTools.cs,ReportErrorToVS,The following statement contains a magic number: int n = subwarning ? 2 : severity == Severity.Warning ? 1 : 0;
