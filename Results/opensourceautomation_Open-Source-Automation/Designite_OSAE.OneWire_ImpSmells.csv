Implementation smell,Namespace,Class,File,Method,Description
Long Method,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,poll,The method has 108 lines of code.
Long Statement,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,RunInterface,The length of the statement  "                string folder = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Windows)' @"Microsoft.NET\Framework64\v2.0.50727"); " is 132.
Long Statement,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,RunInterface,The length of the statement  "                    folder = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Windows)' @"Microsoft.NET\Framework\v2.0.50727"); " is 123.
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,RunInterface,The following statement contains a magic number: if (Environment.Version.Major >= 4)              {                  string folder = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Windows)' @"Microsoft.NET\Framework64\v2.0.50727");                  if (!Directory.Exists(folder))                      folder = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Windows)' @"Microsoft.NET\Framework\v2.0.50727");                    Log.Debug("vjsnativ.dll path: " + folder);                  folder = Path.GetFullPath(folder);                  LoadLibrary(Path.Combine(folder' "vjsnativ.dll"));              }
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,RunInterface,The following statement contains a magic number: if (adapter.adapterDetected())              {                  Log.Info("Adapter Detected");                  adapter.setSearchAllDevices();                    Clock = new System.Threading.Timer(poll' null' 0' 10000);                    if (restarting) restarting = false;              }              else                  Log.Info("Adapter(" + adapterProp + ") not found on port " + port);
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,poll,The following statement contains a magic number: if (threadCount < 2)              {                  lock (thisLock)                  {                      try                      {                          adapter.beginExclusive(true);                          Log.Debug("polling...");                          double temp;                          OneWireContainer owc = null;                            owc = adapter.getFirstDeviceContainer();                            while (owc != null)                          {                              sbyte[] state;                              OSAEObject obj = null;                              string addr' desc;                                string[] ct = owc.GetType().ToString().Split('.');                              string owcType = ct[ct.Length - 1];                                addr = owc.getAddressAsString();                              desc = owc.getDescription();                                Log.Debug("- Device Name: " + owc.getName());                              Log.Debug(" - Type: " + owcType);                              Log.Debug(" - Address: " + addr);                              Log.Debug(" - Description: " + desc);                                switch (owcType)                              {                                  case "OneWireContainer10":                                      //DS1920 or DS18S20 - iButton family type 10                                      try                                      {                                          OneWireContainer10 owc10 = (OneWireContainer10)owc;                                          state = owc10.readDevice();                                          owc10.doTemperatureConvert(state);                                            //Changes the resultion that that will be read                                          owc10.setTemperatureResolution(OneWireContainer10.RESOLUTION_NORMAL' state);                                            obj = OSAEObjectManager.GetObjectByAddress(owc10.getAddressAsString());                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr'""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          temp = tempConvert(owc10.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 10 poll error"' ex); }                                      break;                                    case "OneWireContainer22":                                      //DS1822 - iButton family type 22                                        try                                      { }                                      catch (Exception ex)                                      { Log.Error("Container type 22 poll error"' ex); }                                      break;                                    case "OneWireContainer28":                                      //DS18B20 - iButton family type 28                                         try                                      {                                          OneWireContainer28 owc28 = (OneWireContainer28)owc;                                          state = owc28.readDevice();                                            ////Changes the resolution that that will be read                                          owc28.setTemperatureResolution(OneWireContainer28.RESOLUTION_12_BIT' state);                                            obj = OSAEObjectManager.GetObjectByAddress(addr);                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr' ""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          owc28.doTemperatureConvert(state);                                          temp = tempConvert(owc28.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 28 poll error"' ex); }                                      break;                              }                              owc = adapter.getNextDeviceContainer();                          }                          adapter.endExclusive();                      }                      catch (Exception ex)                      { Log.Error("Cannot get exclusive use of the 1-wire adapter"' ex); }                  }                    threadCount--;                  Log.Debug("Thread Ended.  Threads running: " + threadCount);                  abortCount = 0;              }              else              {                  threadCount--;                  Log.Debug("Thread aborted.  Threads running: " + threadCount);                  abortCount++;                  if (abortCount > 2 && !restarting)                  {                      Log.Debug("Restarting plugin");                      restarting = true;                      Shutdown();                      RunInterface(pName);                  }              }
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,poll,The following statement contains a magic number: if (threadCount < 2)              {                  lock (thisLock)                  {                      try                      {                          adapter.beginExclusive(true);                          Log.Debug("polling...");                          double temp;                          OneWireContainer owc = null;                            owc = adapter.getFirstDeviceContainer();                            while (owc != null)                          {                              sbyte[] state;                              OSAEObject obj = null;                              string addr' desc;                                string[] ct = owc.GetType().ToString().Split('.');                              string owcType = ct[ct.Length - 1];                                addr = owc.getAddressAsString();                              desc = owc.getDescription();                                Log.Debug("- Device Name: " + owc.getName());                              Log.Debug(" - Type: " + owcType);                              Log.Debug(" - Address: " + addr);                              Log.Debug(" - Description: " + desc);                                switch (owcType)                              {                                  case "OneWireContainer10":                                      //DS1920 or DS18S20 - iButton family type 10                                      try                                      {                                          OneWireContainer10 owc10 = (OneWireContainer10)owc;                                          state = owc10.readDevice();                                          owc10.doTemperatureConvert(state);                                            //Changes the resultion that that will be read                                          owc10.setTemperatureResolution(OneWireContainer10.RESOLUTION_NORMAL' state);                                            obj = OSAEObjectManager.GetObjectByAddress(owc10.getAddressAsString());                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr'""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          temp = tempConvert(owc10.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 10 poll error"' ex); }                                      break;                                    case "OneWireContainer22":                                      //DS1822 - iButton family type 22                                        try                                      { }                                      catch (Exception ex)                                      { Log.Error("Container type 22 poll error"' ex); }                                      break;                                    case "OneWireContainer28":                                      //DS18B20 - iButton family type 28                                         try                                      {                                          OneWireContainer28 owc28 = (OneWireContainer28)owc;                                          state = owc28.readDevice();                                            ////Changes the resolution that that will be read                                          owc28.setTemperatureResolution(OneWireContainer28.RESOLUTION_12_BIT' state);                                            obj = OSAEObjectManager.GetObjectByAddress(addr);                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr' ""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          owc28.doTemperatureConvert(state);                                          temp = tempConvert(owc28.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 28 poll error"' ex); }                                      break;                              }                              owc = adapter.getNextDeviceContainer();                          }                          adapter.endExclusive();                      }                      catch (Exception ex)                      { Log.Error("Cannot get exclusive use of the 1-wire adapter"' ex); }                  }                    threadCount--;                  Log.Debug("Thread Ended.  Threads running: " + threadCount);                  abortCount = 0;              }              else              {                  threadCount--;                  Log.Debug("Thread aborted.  Threads running: " + threadCount);                  abortCount++;                  if (abortCount > 2 && !restarting)                  {                      Log.Debug("Restarting plugin");                      restarting = true;                      Shutdown();                      RunInterface(pName);                  }              }
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,poll,The following statement contains a magic number: if (threadCount < 2)              {                  lock (thisLock)                  {                      try                      {                          adapter.beginExclusive(true);                          Log.Debug("polling...");                          double temp;                          OneWireContainer owc = null;                            owc = adapter.getFirstDeviceContainer();                            while (owc != null)                          {                              sbyte[] state;                              OSAEObject obj = null;                              string addr' desc;                                string[] ct = owc.GetType().ToString().Split('.');                              string owcType = ct[ct.Length - 1];                                addr = owc.getAddressAsString();                              desc = owc.getDescription();                                Log.Debug("- Device Name: " + owc.getName());                              Log.Debug(" - Type: " + owcType);                              Log.Debug(" - Address: " + addr);                              Log.Debug(" - Description: " + desc);                                switch (owcType)                              {                                  case "OneWireContainer10":                                      //DS1920 or DS18S20 - iButton family type 10                                      try                                      {                                          OneWireContainer10 owc10 = (OneWireContainer10)owc;                                          state = owc10.readDevice();                                          owc10.doTemperatureConvert(state);                                            //Changes the resultion that that will be read                                          owc10.setTemperatureResolution(OneWireContainer10.RESOLUTION_NORMAL' state);                                            obj = OSAEObjectManager.GetObjectByAddress(owc10.getAddressAsString());                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr'""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          temp = tempConvert(owc10.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 10 poll error"' ex); }                                      break;                                    case "OneWireContainer22":                                      //DS1822 - iButton family type 22                                        try                                      { }                                      catch (Exception ex)                                      { Log.Error("Container type 22 poll error"' ex); }                                      break;                                    case "OneWireContainer28":                                      //DS18B20 - iButton family type 28                                         try                                      {                                          OneWireContainer28 owc28 = (OneWireContainer28)owc;                                          state = owc28.readDevice();                                            ////Changes the resolution that that will be read                                          owc28.setTemperatureResolution(OneWireContainer28.RESOLUTION_12_BIT' state);                                            obj = OSAEObjectManager.GetObjectByAddress(addr);                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr' ""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          owc28.doTemperatureConvert(state);                                          temp = tempConvert(owc28.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 28 poll error"' ex); }                                      break;                              }                              owc = adapter.getNextDeviceContainer();                          }                          adapter.endExclusive();                      }                      catch (Exception ex)                      { Log.Error("Cannot get exclusive use of the 1-wire adapter"' ex); }                  }                    threadCount--;                  Log.Debug("Thread Ended.  Threads running: " + threadCount);                  abortCount = 0;              }              else              {                  threadCount--;                  Log.Debug("Thread aborted.  Threads running: " + threadCount);                  abortCount++;                  if (abortCount > 2 && !restarting)                  {                      Log.Debug("Restarting plugin");                      restarting = true;                      Shutdown();                      RunInterface(pName);                  }              }
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,poll,The following statement contains a magic number: if (threadCount < 2)              {                  lock (thisLock)                  {                      try                      {                          adapter.beginExclusive(true);                          Log.Debug("polling...");                          double temp;                          OneWireContainer owc = null;                            owc = adapter.getFirstDeviceContainer();                            while (owc != null)                          {                              sbyte[] state;                              OSAEObject obj = null;                              string addr' desc;                                string[] ct = owc.GetType().ToString().Split('.');                              string owcType = ct[ct.Length - 1];                                addr = owc.getAddressAsString();                              desc = owc.getDescription();                                Log.Debug("- Device Name: " + owc.getName());                              Log.Debug(" - Type: " + owcType);                              Log.Debug(" - Address: " + addr);                              Log.Debug(" - Description: " + desc);                                switch (owcType)                              {                                  case "OneWireContainer10":                                      //DS1920 or DS18S20 - iButton family type 10                                      try                                      {                                          OneWireContainer10 owc10 = (OneWireContainer10)owc;                                          state = owc10.readDevice();                                          owc10.doTemperatureConvert(state);                                            //Changes the resultion that that will be read                                          owc10.setTemperatureResolution(OneWireContainer10.RESOLUTION_NORMAL' state);                                            obj = OSAEObjectManager.GetObjectByAddress(owc10.getAddressAsString());                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr'""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          temp = tempConvert(owc10.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 10 poll error"' ex); }                                      break;                                    case "OneWireContainer22":                                      //DS1822 - iButton family type 22                                        try                                      { }                                      catch (Exception ex)                                      { Log.Error("Container type 22 poll error"' ex); }                                      break;                                    case "OneWireContainer28":                                      //DS18B20 - iButton family type 28                                         try                                      {                                          OneWireContainer28 owc28 = (OneWireContainer28)owc;                                          state = owc28.readDevice();                                            ////Changes the resolution that that will be read                                          owc28.setTemperatureResolution(OneWireContainer28.RESOLUTION_12_BIT' state);                                            obj = OSAEObjectManager.GetObjectByAddress(addr);                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr' ""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          owc28.doTemperatureConvert(state);                                          temp = tempConvert(owc28.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 28 poll error"' ex); }                                      break;                              }                              owc = adapter.getNextDeviceContainer();                          }                          adapter.endExclusive();                      }                      catch (Exception ex)                      { Log.Error("Cannot get exclusive use of the 1-wire adapter"' ex); }                  }                    threadCount--;                  Log.Debug("Thread Ended.  Threads running: " + threadCount);                  abortCount = 0;              }              else              {                  threadCount--;                  Log.Debug("Thread aborted.  Threads running: " + threadCount);                  abortCount++;                  if (abortCount > 2 && !restarting)                  {                      Log.Debug("Restarting plugin");                      restarting = true;                      Shutdown();                      RunInterface(pName);                  }              }
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,tempConvert,The following statement contains a magic number: if (uom == "F") temp = temp * 9 / 5 + 32;
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,tempConvert,The following statement contains a magic number: if (uom == "F") temp = temp * 9 / 5 + 32;
Magic Number,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,tempConvert,The following statement contains a magic number: if (uom == "F") temp = temp * 9 / 5 + 32;
Missing Default,OSAE.OneWire,OneWire,C:\repos\opensourceautomation_Open-Source-Automation\Plugins\OSAE.OneWire\OneWire.cs,poll,The following switch statement is missing a default case: switch (owcType)                              {                                  case "OneWireContainer10":                                      //DS1920 or DS18S20 - iButton family type 10                                      try                                      {                                          OneWireContainer10 owc10 = (OneWireContainer10)owc;                                          state = owc10.readDevice();                                          owc10.doTemperatureConvert(state);                                            //Changes the resultion that that will be read                                          owc10.setTemperatureResolution(OneWireContainer10.RESOLUTION_NORMAL' state);                                            obj = OSAEObjectManager.GetObjectByAddress(owc10.getAddressAsString());                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr'""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          temp = tempConvert(owc10.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 10 poll error"' ex); }                                      break;                                    case "OneWireContainer22":                                      //DS1822 - iButton family type 22                                        try                                      { }                                      catch (Exception ex)                                      { Log.Error("Container type 22 poll error"' ex); }                                      break;                                    case "OneWireContainer28":                                      //DS18B20 - iButton family type 28                                         try                                      {                                          OneWireContainer28 owc28 = (OneWireContainer28)owc;                                          state = owc28.readDevice();                                            ////Changes the resolution that that will be read                                          owc28.setTemperatureResolution(OneWireContainer28.RESOLUTION_12_BIT' state);                                            obj = OSAEObjectManager.GetObjectByAddress(addr);                                          if (obj == null)                                          {                                              OSAEObjectManager.ObjectAdd("Temp Sensor-" + addr' ""' "Temp Sensor-" + addr' "1WIRE TEMP SENSOR"' addr' ""' 30' true);                                              obj = OSAEObjectManager.GetObjectByAddress(addr);                                          }                                            //Reads the temperature                                          owc28.doTemperatureConvert(state);                                          temp = tempConvert(owc28.getTemperature(state));                                          Log.Debug(" - Temperature: " + temp);                                          OSAEObjectPropertyManager.ObjectPropertySet(obj.Name' "Temperature"' temp.ToString()' pName);                                      }                                      catch (Exception ex)                                      { Log.Error("Container type 28 poll error"' ex); }                                      break;                              }
