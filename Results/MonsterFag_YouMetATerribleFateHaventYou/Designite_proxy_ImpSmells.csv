Implementation smell,Namespace,Class,File,Method,Description
Complex Method,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessCli,Cyclomatic complexity of the method is 8
Complex Method,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,Cyclomatic complexity of the method is 11
Complex Method,wServer.realm,JsonMap,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\JsonMap.cs,ToJson,Cyclomatic complexity of the method is 25
Long Statement,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The length of the statement  "			map.Init (IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 0))' IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 4))); " is 166.
Complex Conditional,wServer.realm,JsonMap,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\JsonMap.cs,ToJson,The conditional expression  "!((locs [i].objs != null && loc.objs != null) || (locs [i].objs == null && loc.objs == null))"  is complex.
Empty Catch Block,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessCli,The method has an empty catch block.
Empty Catch Block,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The method has an empty catch block.
Empty Catch Block,wServer,Program,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\Program.cs,ServePolicyFile,The method has an empty catch block.
Empty Catch Block,wServer,Program,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\Program.cs,Listen,The method has an empty catch block.
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,BeginProcess,The following statement contains a magic number: dest.Connect ("ec2-54-244-123-81.us-west-2.compute.amazonaws.com"' 2050);  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessCli,The following statement contains a magic number: try {  	var rdr = new NReader (new NetworkStream (skt));  	var wtr = new NWriter (dest.GetStream ());  	while (true) {  		var len = rdr.ReadInt32 ();  		var id = rdr.ReadByte ();  		var content = rdr.ReadBytes (len - 5);  		var state = ReceiveKey.SaveState ();  		content = ReceiveKey.Crypt (content);  		ReceiveKey.LoadState (state);  		//if (id == 17)  		//{  		//    MemoryStream ms = new MemoryStream();  		//    using (NWriter w = new NWriter(ms))  		//    using (NReader r = new NReader(new MemoryStream(content)))  		//    {  		//        w.WriteUTF(r.ReadUTF());  		//        Console.WriteLine(r.ReadInt32()); w.Write(-3);  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.Write(r.ReadInt32());  		//        var c = r.ReadBytes(r.ReadInt16());  		//        w.Write((short)c.Length);  		//        w.Write(c);  		//        w.Write32UTF(r.Read32UTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//    }  		//    content = ms.ToArray();  		//}  		if (id == 4) {  			using (var r = new NReader (new MemoryStream (content))) {  				var Name = rdr.ReadUTF ();  				var Host = rdr.ReadUTF ();  				var Port = rdr.ReadInt32 ();  				var GameId = rdr.ReadInt32 ();  				var KeyTime = rdr.ReadInt32 ();  				var Key = rdr.ReadBytes (rdr.ReadInt16 ());  			}  		}  		content = ReceiveKey.Crypt (content);  		ReceiveKey.LoadState (state);  		wtr.Write (len);  		wtr.Write ((byte)id);  		wtr.Write (content);  		cliPkts.Add (new Packet () {  			id = id'  			content = ReceiveKey.Crypt (content)  		});  	}  }  catch {  }  finally {  	skt.Close ();  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessCli,The following statement contains a magic number: try {  	var rdr = new NReader (new NetworkStream (skt));  	var wtr = new NWriter (dest.GetStream ());  	while (true) {  		var len = rdr.ReadInt32 ();  		var id = rdr.ReadByte ();  		var content = rdr.ReadBytes (len - 5);  		var state = ReceiveKey.SaveState ();  		content = ReceiveKey.Crypt (content);  		ReceiveKey.LoadState (state);  		//if (id == 17)  		//{  		//    MemoryStream ms = new MemoryStream();  		//    using (NWriter w = new NWriter(ms))  		//    using (NReader r = new NReader(new MemoryStream(content)))  		//    {  		//        w.WriteUTF(r.ReadUTF());  		//        Console.WriteLine(r.ReadInt32()); w.Write(-3);  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.Write(r.ReadInt32());  		//        var c = r.ReadBytes(r.ReadInt16());  		//        w.Write((short)c.Length);  		//        w.Write(c);  		//        w.Write32UTF(r.Read32UTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//        w.WriteUTF(r.ReadUTF());  		//    }  		//    content = ms.ToArray();  		//}  		if (id == 4) {  			using (var r = new NReader (new MemoryStream (content))) {  				var Name = rdr.ReadUTF ();  				var Host = rdr.ReadUTF ();  				var Port = rdr.ReadInt32 ();  				var GameId = rdr.ReadInt32 ();  				var KeyTime = rdr.ReadInt32 ();  				var Key = rdr.ReadBytes (rdr.ReadInt16 ());  			}  		}  		content = ReceiveKey.Crypt (content);  		ReceiveKey.LoadState (state);  		wtr.Write (len);  		wtr.Write ((byte)id);  		wtr.Write (content);  		cliPkts.Add (new Packet () {  			id = id'  			content = ReceiveKey.Crypt (content)  		});  	}  }  catch {  }  finally {  	skt.Close ();  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessCli,The following statement contains a magic number: while (true) {  	var len = rdr.ReadInt32 ();  	var id = rdr.ReadByte ();  	var content = rdr.ReadBytes (len - 5);  	var state = ReceiveKey.SaveState ();  	content = ReceiveKey.Crypt (content);  	ReceiveKey.LoadState (state);  	//if (id == 17)  	//{  	//    MemoryStream ms = new MemoryStream();  	//    using (NWriter w = new NWriter(ms))  	//    using (NReader r = new NReader(new MemoryStream(content)))  	//    {  	//        w.WriteUTF(r.ReadUTF());  	//        Console.WriteLine(r.ReadInt32()); w.Write(-3);  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.Write(r.ReadInt32());  	//        var c = r.ReadBytes(r.ReadInt16());  	//        w.Write((short)c.Length);  	//        w.Write(c);  	//        w.Write32UTF(r.Read32UTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//    }  	//    content = ms.ToArray();  	//}  	if (id == 4) {  		using (var r = new NReader (new MemoryStream (content))) {  			var Name = rdr.ReadUTF ();  			var Host = rdr.ReadUTF ();  			var Port = rdr.ReadInt32 ();  			var GameId = rdr.ReadInt32 ();  			var KeyTime = rdr.ReadInt32 ();  			var Key = rdr.ReadBytes (rdr.ReadInt16 ());  		}  	}  	content = ReceiveKey.Crypt (content);  	ReceiveKey.LoadState (state);  	wtr.Write (len);  	wtr.Write ((byte)id);  	wtr.Write (content);  	cliPkts.Add (new Packet () {  		id = id'  		content = ReceiveKey.Crypt (content)  	});  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessCli,The following statement contains a magic number: while (true) {  	var len = rdr.ReadInt32 ();  	var id = rdr.ReadByte ();  	var content = rdr.ReadBytes (len - 5);  	var state = ReceiveKey.SaveState ();  	content = ReceiveKey.Crypt (content);  	ReceiveKey.LoadState (state);  	//if (id == 17)  	//{  	//    MemoryStream ms = new MemoryStream();  	//    using (NWriter w = new NWriter(ms))  	//    using (NReader r = new NReader(new MemoryStream(content)))  	//    {  	//        w.WriteUTF(r.ReadUTF());  	//        Console.WriteLine(r.ReadInt32()); w.Write(-3);  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.Write(r.ReadInt32());  	//        var c = r.ReadBytes(r.ReadInt16());  	//        w.Write((short)c.Length);  	//        w.Write(c);  	//        w.Write32UTF(r.Read32UTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//        w.WriteUTF(r.ReadUTF());  	//    }  	//    content = ms.ToArray();  	//}  	if (id == 4) {  		using (var r = new NReader (new MemoryStream (content))) {  			var Name = rdr.ReadUTF ();  			var Host = rdr.ReadUTF ();  			var Port = rdr.ReadInt32 ();  			var GameId = rdr.ReadInt32 ();  			var KeyTime = rdr.ReadInt32 ();  			var Key = rdr.ReadBytes (rdr.ReadInt16 ());  		}  	}  	content = ReceiveKey.Crypt (content);  	ReceiveKey.LoadState (state);  	wtr.Write (len);  	wtr.Write ((byte)id);  	wtr.Write (content);  	cliPkts.Add (new Packet () {  		id = id'  		content = ReceiveKey.Crypt (content)  	});  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessCli,The following statement contains a magic number: if (id == 4) {  	using (var r = new NReader (new MemoryStream (content))) {  		var Name = rdr.ReadUTF ();  		var Host = rdr.ReadUTF ();  		var Port = rdr.ReadInt32 ();  		var GameId = rdr.ReadInt32 ();  		var KeyTime = rdr.ReadInt32 ();  		var Key = rdr.ReadBytes (rdr.ReadInt16 ());  	}  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: try {  	var rdr = new NReader (dest.GetStream ());  	var wtr = new NWriter (new NetworkStream (skt));  	while (true) {  		var len = rdr.ReadInt32 () - 5;  		var id = rdr.ReadByte ();  		var content = rdr.ReadBytes (len);  		wtr.Write (len + 5);  		wtr.Write ((byte)id);  		wtr.Write (content);  		svrPkts.Add (new Packet () {  			id = id'  			content = SendKey.Crypt (content)  		});  	}  }  catch {  }  finally {  	skt.Close ();  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: try {  	var rdr = new NReader (dest.GetStream ());  	var wtr = new NWriter (new NetworkStream (skt));  	while (true) {  		var len = rdr.ReadInt32 () - 5;  		var id = rdr.ReadByte ();  		var content = rdr.ReadBytes (len);  		wtr.Write (len + 5);  		wtr.Write ((byte)id);  		wtr.Write (content);  		svrPkts.Add (new Packet () {  			id = id'  			content = SendKey.Crypt (content)  		});  	}  }  catch {  }  finally {  	skt.Close ();  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: while (true) {  	var len = rdr.ReadInt32 () - 5;  	var id = rdr.ReadByte ();  	var content = rdr.ReadBytes (len);  	wtr.Write (len + 5);  	wtr.Write ((byte)id);  	wtr.Write (content);  	svrPkts.Add (new Packet () {  		id = id'  		content = SendKey.Crypt (content)  	});  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: while (true) {  	var len = rdr.ReadInt32 () - 5;  	var id = rdr.ReadByte ();  	var content = rdr.ReadBytes (len);  	wtr.Write (len + 5);  	wtr.Write ((byte)id);  	wtr.Write (content);  	svrPkts.Add (new Packet () {  		id = id'  		content = SendKey.Crypt (content)  	});  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: wtr.Write (len + 5);  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: for (var i = 0; i < svrPkts.Count; i++) {  	File.WriteAllBytes ("svr_pkt/" + i + "_" + svrPkts [i].id' svrPkts [i].content);  	if (svrPkts [i].id == 37) {  		map.Init (IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 0))' IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 4)));  		File.WriteAllBytes ("mapinfo.packet"' svrPkts [i].content);  	}  	if (svrPkts [i].id == 5) {  		using (var rdr = new NReader (new MemoryStream (svrPkts [i].content))) {  			var count = rdr.ReadInt16 ();  			for (var x = 0; x < count; x++) {  				map.Tiles [rdr.ReadInt16 ()] [rdr.ReadInt16 ()] = (Tile)rdr.ReadByte ();  			}  			count = rdr.ReadInt16 ();  			for (var x = 0; x < count; x++) {  				var def = ObjectDef.Read (rdr);  				def.Stats.Position.X -= 0.5F;  				def.Stats.Position.Y -= 0.5F;  				if (def.Stats.Position.X == (int)def.Stats.Position.X && def.Stats.Position.Y == (int)def.Stats.Position.Y) {  					var _x = (int)def.Stats.Position.X;  					var _y = (int)def.Stats.Position.Y;  					Array.Resize (ref map.Entities [_x] [_y]' map.Entities [_x] [_y].Length + 1);  					var arr = map.Entities [_x] [_y];  					arr [arr.Length - 1] = def;  				}  			}  		}  	}  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: for (var i = 0; i < svrPkts.Count; i++) {  	File.WriteAllBytes ("svr_pkt/" + i + "_" + svrPkts [i].id' svrPkts [i].content);  	if (svrPkts [i].id == 37) {  		map.Init (IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 0))' IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 4)));  		File.WriteAllBytes ("mapinfo.packet"' svrPkts [i].content);  	}  	if (svrPkts [i].id == 5) {  		using (var rdr = new NReader (new MemoryStream (svrPkts [i].content))) {  			var count = rdr.ReadInt16 ();  			for (var x = 0; x < count; x++) {  				map.Tiles [rdr.ReadInt16 ()] [rdr.ReadInt16 ()] = (Tile)rdr.ReadByte ();  			}  			count = rdr.ReadInt16 ();  			for (var x = 0; x < count; x++) {  				var def = ObjectDef.Read (rdr);  				def.Stats.Position.X -= 0.5F;  				def.Stats.Position.Y -= 0.5F;  				if (def.Stats.Position.X == (int)def.Stats.Position.X && def.Stats.Position.Y == (int)def.Stats.Position.Y) {  					var _x = (int)def.Stats.Position.X;  					var _y = (int)def.Stats.Position.Y;  					Array.Resize (ref map.Entities [_x] [_y]' map.Entities [_x] [_y].Length + 1);  					var arr = map.Entities [_x] [_y];  					arr [arr.Length - 1] = def;  				}  			}  		}  	}  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: for (var i = 0; i < svrPkts.Count; i++) {  	File.WriteAllBytes ("svr_pkt/" + i + "_" + svrPkts [i].id' svrPkts [i].content);  	if (svrPkts [i].id == 37) {  		map.Init (IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 0))' IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 4)));  		File.WriteAllBytes ("mapinfo.packet"' svrPkts [i].content);  	}  	if (svrPkts [i].id == 5) {  		using (var rdr = new NReader (new MemoryStream (svrPkts [i].content))) {  			var count = rdr.ReadInt16 ();  			for (var x = 0; x < count; x++) {  				map.Tiles [rdr.ReadInt16 ()] [rdr.ReadInt16 ()] = (Tile)rdr.ReadByte ();  			}  			count = rdr.ReadInt16 ();  			for (var x = 0; x < count; x++) {  				var def = ObjectDef.Read (rdr);  				def.Stats.Position.X -= 0.5F;  				def.Stats.Position.Y -= 0.5F;  				if (def.Stats.Position.X == (int)def.Stats.Position.X && def.Stats.Position.Y == (int)def.Stats.Position.Y) {  					var _x = (int)def.Stats.Position.X;  					var _y = (int)def.Stats.Position.Y;  					Array.Resize (ref map.Entities [_x] [_y]' map.Entities [_x] [_y].Length + 1);  					var arr = map.Entities [_x] [_y];  					arr [arr.Length - 1] = def;  				}  			}  		}  	}  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: if (svrPkts [i].id == 37) {  	map.Init (IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 0))' IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 4)));  	File.WriteAllBytes ("mapinfo.packet"' svrPkts [i].content);  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: if (svrPkts [i].id == 37) {  	map.Init (IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 0))' IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 4)));  	File.WriteAllBytes ("mapinfo.packet"' svrPkts [i].content);  }  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: map.Init (IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 0))' IPAddress.NetworkToHostOrder (BitConverter.ToInt32 (svrPkts [i].content' 4)));  
Magic Number,wServer,ClientProcessor,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\ClientProcessor.cs,ProcessSvr,The following statement contains a magic number: if (svrPkts [i].id == 5) {  	using (var rdr = new NReader (new MemoryStream (svrPkts [i].content))) {  		var count = rdr.ReadInt16 ();  		for (var x = 0; x < count; x++) {  			map.Tiles [rdr.ReadInt16 ()] [rdr.ReadInt16 ()] = (Tile)rdr.ReadByte ();  		}  		count = rdr.ReadInt16 ();  		for (var x = 0; x < count; x++) {  			var def = ObjectDef.Read (rdr);  			def.Stats.Position.X -= 0.5F;  			def.Stats.Position.Y -= 0.5F;  			if (def.Stats.Position.X == (int)def.Stats.Position.X && def.Stats.Position.Y == (int)def.Stats.Position.Y) {  				var _x = (int)def.Stats.Position.X;  				var _y = (int)def.Stats.Position.Y;  				Array.Resize (ref map.Entities [_x] [_y]' map.Entities [_x] [_y].Length + 1);  				var arr = map.Entities [_x] [_y];  				arr [arr.Length - 1] = def;  			}  		}  	}  }  
Magic Number,wServer,Program,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\Program.cs,Main,The following statement contains a magic number: svrSkt.Bind (new IPEndPoint (IPAddress.Any' 2050));  
Magic Number,wServer,RC4,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\RC4.cs,RC4,The following statement contains a magic number: for (var i = 0; i < 256; i++) {  	m_State [i] = (byte)i;  }  
Magic Number,wServer,RC4,C:\repos\MonsterFag_YouMetATerribleFateHaventYou\proxy\RC4.cs,RC4,The following statement contains a magic number: for (var i = 0; i < 256; i++) {  	index2 = ((key [index1] & 0xff) + (m_State [i] & 0xff) + index2) & 0xff;  	tmp = m_State [i];  	m_State [i] = m_State [index2];  	m_State [index2] = tmp;  	index1 = (index1 + 1) % key.Length;  }  
